import{b as r}from"./utils-CHsLvtYz.js";import{I as C,S as E}from"./constants-r0ry0Tln.js";function v(d,c){const a=c(d),n=["img-wrapper"];a.selected&&n.push("selected");const t=r("div",n,{"data-spirit-name":d.name}),e=r("div","img-box");if(t.appendChild(e),a.selected){const l=r("div","center-check-mark",{text:"✓"});e.appendChild(l)}a.registrationCompleted&&e.classList.add("registration-completed"),a.bondCompleted&&e.classList.add("bond-completed");const o=r("img","",{src:`${d.image}`,alt:d.name,loading:"lazy"});if(e.appendChild(o),a.level25BindAvailable){const l=r("div","level25-indicator");e.appendChild(l)}const s=r("small","img-name",{text:d.name});return t.appendChild(s),t}function b(d,c,a){const n=r("div","image-container-grid");return d.forEach(t=>{const e=v(t,a);e.addEventListener("click",()=>c(t)),n.appendChild(e)}),n}function w(d,c,a){const n=r("div","image-container-grouped"),t=d.reduce((l,i)=>((l[i.influence||"기타"]=l[i.influence||"기타"]||[]).push(i),l),{}),e=(l,i)=>{const h=r("div","influence-group"),p=r("div","header-wrapper"),g=r("h3","influence-header",{text:`${l} (${i.length})`});p.appendChild(g),h.appendChild(p);const f=r("div","influence-items");return i.forEach(u=>{const m=v(u,a);m.addEventListener("click",()=>c(u)),f.appendChild(m)}),h.appendChild(f),h},o=new Set;C.forEach(l=>{const i=r("div","influence-row");let h=!1;l.forEach(p=>{t[p]&&(i.appendChild(e(p,t[p])),o.add(p),h=!0)}),h&&n.appendChild(i)});const s=Object.keys(t).filter(l=>!o.has(l)).sort();if(s.length>0){const l=r("div","influence-row");s.forEach(i=>l.appendChild(e(i,t[i]))),n.appendChild(l)}return n}function k({container:d,spirits:c,onSpiritClick:a,getSpiritState:n,groupByInfluence:t}){if(d.innerHTML="",c.length===0){d.innerHTML='<p class="empty-state-message">조건에 맞는 환수가 없습니다.</p>';return}let e;t?e=w(c,a,n):e=b(c,a,n),d.appendChild(e)}function x(d,c,a){const n=r("div","stat-filter-container"),t=r("select","stat-filter",{id:"statFilter"});t.appendChild(r("option","",{value:"",text:"능력치 필터"}));const e=r("button","clear-filter-btn",{text:"초기화"});e.style.display="none",y(t,c);const o=function(){const i=this.value;e.style.display=i?"block":"none",a(i)},s=()=>{t.value="",e.style.display="none",a("")};return t.addEventListener("change",o),e.addEventListener("click",s),n.append(t,e),d.appendChild(n),{statFilter:t,clearBtn:e,cleanup:()=>{t.removeEventListener("change",o),e.removeEventListener("click",s),n.remove()}}}function y(d,c){const a=new Set;c.forEach(n=>n.stats.forEach(t=>{t.bindStat&&Object.keys(t.bindStat).forEach(e=>a.add(e)),t.registrationStat&&Object.keys(t.registrationStat).forEach(e=>a.add(e))})),[...a].sort().forEach(n=>d.appendChild(r("option","",{value:n,text:E[n]||n})))}export{x as c,k as r};
