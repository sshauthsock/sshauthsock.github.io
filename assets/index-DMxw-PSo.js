const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/spiritInfo-Bq_gyKRd.js","assets/utils-CHsLvtYz.js","assets/modalHandler-CdyZRqDY.js","assets/constants-r0ry0Tln.js","assets/supportMessage-DQwvUf77.js","assets/statFilter-_wJaYcst.js","assets/bondCalculator-Buupt9mG.js","assets/resultModal-DuH_TlHP.js","assets/spiritRanking-BvyigT-s.js","assets/soulCalculator-TxP9ptmb.js","assets/chakCalculator-Bqa4Jiot.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const M="modulepreload",B=function(e){return"/"+e},T={},h=function(t,o,i){let n=Promise.resolve();if(o&&o.length>0){let O=function(l){return Promise.all(l.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");n=O(o.map(l=>{if(l=B(l),l in T)return;T[l]=!0;const g=l.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${y}`))return;const d=document.createElement("link");if(d.rel=g?"stylesheet":M,g||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),g)return new Promise((R,H)=>{d.addEventListener("load",R),d.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return n.then(s=>{for(const a of s||[])a.status==="rejected"&&r(a.reason);return t().catch(r)})},f="https://wind-app-backend-y7qnnpfkrq-du.a.run.app",S={};function D(e){if(e&&typeof e.image=="string"){const t=e.image.replace(/^images\//,"assets/img/");return{...e,image:t}}return e}function w(e){return Array.isArray(e)?e.map(D):e}async function b(e){if(!e.ok){const t=await e.json().catch(()=>({error:"서버 응답을 읽을 수 없습니다."}));throw console.error(`API Error ${e.status}:`,t.error||e.statusText,t),new Error(t.error||`서버 오류: ${e.statusText}`)}return e.json()}async function x(e,t,o=!1){const i=sessionStorage.getItem(e);if(i)try{return JSON.parse(i)}catch(a){console.error(`[Cache Error] Failed to parse sessionStorage data for ${e}, fetching fresh.`,a),sessionStorage.removeItem(e)}const n=await fetch(t),r=await b(n);let s=r;o&&Array.isArray(r)&&(s=w(r));try{sessionStorage.setItem(e,JSON.stringify(s))}catch(a){console.error(`[Cache Error] Failed to save to sessionStorage for ${e}:`,a)}return s}async function N(e,t){if(S[e])return S[e];const o=await fetch(t),i=await b(o);let n=JSON.parse(JSON.stringify(i));if(e.includes("/api/rankings")&&Array.isArray(n.rankings)){const r=e.includes("type=bond")?"bond":e.includes("type=stat")?"stat":null;r==="bond"?n.rankings=n.rankings.map(s=>{let a=s;return Array.isArray(a.spirits)&&(a.spirits=w(a.spirits)),a.bindStat!==void 0&&a.bindStats===void 0&&(a.bindStats=a.bindStat),a}):r==="stat"&&(n.rankings=w(n.rankings))}return S[e]=n,n}async function q(){return x("allSpiritsData",`${f}/api/alldata`,!0)}async function F(e){const t=await fetch(`${f}/api/calculate/bond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({creatures:e})}),o=await b(t);return o&&Array.isArray(o.spirits)&&(o.spirits=w(o.spirits)),o}async function V(e,t,o=""){let i=`${f}/api/rankings?category=${encodeURIComponent(e)}&type=${encodeURIComponent(t)}`;return t==="stat"&&o&&(i+=`&statKey=${encodeURIComponent(o)}`),N(i,i)}async function W(){return x("soulExpTable",`${f}/api/soul/exp-table`)}async function G(e){const t=await fetch(`${f}/api/calculate/soul`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return b(t)}async function K(){return x("chakData",`${f}/api/chak/data`)}async function Z(e){const t=await fetch(`${f}/api/calculate/chak`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return b(t)}const m={allSpirits:[],currentPageModule:null};function j(e){m.allSpirits=e}const C="loading-indicator-style";let c=null;function J(){if(document.getElementById(C))return;const e=document.createElement("style");e.id=C,e.textContent=`
        .loading-overlay {
            position: absolute; /* Changed from fixed to absolute for #app-container */
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 10000; backdrop-filter: blur(4px);
            opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s;
        }
        .loading-overlay.visible { opacity: 1; visibility: visible; }
        .loading-container {
            background-color: #ffffff; border-radius: 15px; padding: 30px;
            text-align: center; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 400px; width: 90%;
        }
        .loading-spinner {
            border: 5px solid #e0e0e0; width: 60px; height: 60px;
            border-radius: 50%; border-top-color: #3498db;
            margin: 0 auto 20px; animation: spin 1.2s linear infinite;
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .loading-text { margin: 15px 0; color: #333; font-size: 20px; font-weight: bold; }
        .loading-subtext { color: #666; font-size: 14px; margin-bottom: 5px; }
    `,document.head.appendChild(e)}function k(e,t="처리 중...",o="잠시만 기다려주세요."){if(!e){console.warn("Loading indicator container not provided.");return}c&&(c.remove(),c=null),J(),c=document.createElement("div"),c.className="loading-overlay",c.innerHTML=`
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">${t}</div>
            <div class="loading-subtext">${o}</div>
        </div>
    `,e.style.position="relative",e.appendChild(c),requestAnimationFrame(()=>{c?.classList.add("visible")})}function $(){c&&(c.classList.remove("visible"),c.remove(),c=null)}const U={spiritInfo:()=>h(()=>import("./spiritInfo-Bq_gyKRd.js"),__vite__mapDeps([0,1,2,3,4,5])),bondCalculator:()=>h(()=>import("./bondCalculator-Buupt9mG.js"),__vite__mapDeps([6,1,7,3,4,5])),spiritRanking:()=>h(()=>import("./spiritRanking-BvyigT-s.js"),__vite__mapDeps([8,1,2,3,4,7])),soulCalculator:()=>h(()=>import("./soulCalculator-TxP9ptmb.js"),__vite__mapDeps([9,1])),chakCalculator:()=>h(()=>import("./chakCalculator-Bqa4Jiot.js"),__vite__mapDeps([10,1,4]))},p=document.getElementById("app-container"),_=document.getElementById("mainTabs"),E=document.getElementById("helpBtn"),u=document.getElementById("helpTooltip"),P=document.getElementById("closeHelp"),L=document.getElementById("currentHelpTitle"),v=document.getElementById("pageSpecificHelpContent");E&&u&&P&&L&&v?(E.addEventListener("click",e=>{e.stopPropagation(),u.style.display=u.style.display==="block"?"none":"block",document.body.style.overflow=u.style.display==="block"?"hidden":"auto"}),P.addEventListener("click",e=>{e.stopPropagation(),u.style.display="none",document.body.style.overflow="auto"}),document.addEventListener("click",e=>{!E.contains(e.target)&&!u.contains(e.target)&&u.style.display==="block"&&(u.style.display="none",document.body.style.overflow="auto")})):console.error("Help button or related tooltip elements not found in DOM for initialization.");async function A(){const e=_.querySelector(".tab.active"),t=e?e.dataset.page:"spiritInfo",o=e?e.textContent:"환수 정보";if(m.currentPageModule?.cleanup)try{m.currentPageModule.cleanup()}catch(i){console.error("[Router] Error during page cleanup:",i)}p.innerHTML="",k(p,"페이지 로딩 중...","필요한 모듈을 불러오고 있습니다...");try{const i=U[t];if(!i)throw new Error(`'${t}' 페이지를 찾을 수 없습니다.`);const n=await i();if(m.currentPageModule=n,n.init){if((!Array.isArray(m.allSpirits)||m.allSpirits.length===0)&&console.warn("Global spirits data is empty or not an array when routing. This might cause errors on pages depending on it."),await n.init(p),L&&v?(L.textContent=`${o} 도움말`,n.getHelpContentHTML?v.innerHTML=n.getHelpContentHTML():v.innerHTML='<div class="content-block"><p class="text-center text-light mt-md">이 페이지에 대한 특정 도움말은 없습니다.</p></div>'):console.error("Help tooltip specific content elements not found for update within route()."),typeof gtag=="function"){const r=`/bayeon-hwayeon/${t}`;document.title=`바연화연 | ${o}`,gtag("event","page_view",{page_title:o,page_path:r})}}else console.warn(`Page module '${t}' does not have an init() function.`),p.innerHTML='<p class="error-message">페이지를 초기화할 수 없습니다. (init 함수 없음)</p>'}catch(i){console.error(`[Router] Failed to load or initialize page '${t}':`,i),p.innerHTML=`<p class="error-message">페이지를 불러오는 중 오류가 발생했습니다: ${i.message}</p>`}finally{$()}}const I=document.querySelector(".footer-report-btn");I&&typeof gtag=="function"&&I.addEventListener("click",()=>{gtag("event","interaction",{event_category:"footer_action",event_label:"Report Button Click",event_action:"Click",link_url:"https://open.kakao.com/o/gZdiGDsh",page_location:window.location.href,page_title:document.title})});_.addEventListener("click",e=>{e.target.matches(".tab")&&!e.target.classList.contains("active")&&(_.querySelector(".tab.active")?.classList.remove("active"),e.target.classList.add("active"),A())});async function z(){k(p,"초기 데이터 로딩 중","서버에서 환수 정보를 불러오고 있습니다...");try{const t=(await q()).map(o=>{const i=o.image.replace(/^images\//,"assets/img/");return{...o,image:i}});j(t),await A()}catch(e){console.error("애플리케이션 초기화 실패:",e),p.innerHTML=`<p class="error-message">애플리케이션 초기화 실패: 데이터를 불러오는 데 실패했습니다. (${e.message})</p>`}finally{$()}}z();export{k as a,W as b,F as c,G as d,K as e,V as f,Z as g,$ as h,m as s};
