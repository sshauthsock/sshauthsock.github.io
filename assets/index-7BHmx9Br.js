const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/spiritInfo-CMJvM171.js","assets/utils-CHsLvtYz.js","assets/modalHandler-DvetA_GR.js","assets/constants-lx1P6xCQ.js","assets/statFilter-C1yLqHyh.js","assets/bondCalculator-CAGFy_1G.js","assets/resultModal-DOvUi161.js","assets/spiritRanking-CIgYb4PX.js","assets/soulCalculator-CvgnZBdK.js","assets/chakCalculator-BBU37JJR.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const M="modulepreload",B=function(e){return"/"+e},x={},y=function(t,o,a){let n=Promise.resolve();if(o&&o.length>0){let O=function(l){return Promise.all(l.map(g=>Promise.resolve(g).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),i=s?.nonce||s?.getAttribute("nonce");n=O(o.map(l=>{if(l=B(l),l in x)return;x[l]=!0;const g=l.endsWith(".css"),m=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const d=document.createElement("link");if(d.rel=g?"stylesheet":M,g||(d.as="script"),d.crossOrigin="",d.href=l,i&&d.setAttribute("nonce",i),document.head.appendChild(d),g)return new Promise((R,H)=>{d.addEventListener("load",R),d.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return n.then(s=>{for(const i of s||[])i.status==="rejected"&&r(i.reason);return t().catch(r)})},f="https://wind-app-backend-462093198351.asia-northeast3.run.app",w={};function D(e){if(e&&typeof e.image=="string"){const t=e.image.replace(/^images\//,"assets/img/");return{...e,image:t}}return e}function b(e){return Array.isArray(e)?e.map(D):e}async function h(e){if(!e.ok){const t=await e.json().catch(()=>({error:"서버 응답을 읽을 수 없습니다."}));throw console.error(`API Error ${e.status}:`,t.error||e.statusText,t),new Error(t.error||`서버 오류: ${e.statusText}`)}return e.json()}async function C(e,t,o=!1){const a=sessionStorage.getItem(e);if(a)try{return console.log(`[Cache] Using sessionStorage cached data for key: ${e}`),JSON.parse(a)}catch(i){console.error(`[Cache Error] Failed to parse sessionStorage data for ${e}, fetching fresh.`,i),sessionStorage.removeItem(e)}const n=await fetch(t),r=await h(n);let s=r;o&&Array.isArray(r)&&(s=b(r));try{sessionStorage.setItem(e,JSON.stringify(s))}catch(i){console.error(`[Cache Error] Failed to save to sessionStorage for ${e}:`,i)}return s}async function N(e,t){if(w[e])return console.log(`[Cache] Using memory cached data for key: ${e}`),w[e];const o=await fetch(t),a=await h(o);let n=JSON.parse(JSON.stringify(a));if(e.includes("/api/rankings")&&Array.isArray(n.rankings)){const r=e.includes("type=bond")?"bond":e.includes("type=stat")?"stat":null;r==="bond"?n.rankings=n.rankings.map(s=>{let i=s;return Array.isArray(i.spirits)&&(i.spirits=b(i.spirits)),i.bindStat!==void 0&&i.bindStats===void 0&&(i.bindStats=i.bindStat),i}):r==="stat"&&(n.rankings=b(n.rankings))}return w[e]=n,n}async function U(){return C("allSpiritsData",`${f}/api/alldata`,!0)}async function V(e){const t=await fetch(`${f}/api/calculate/bond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({creatures:e})}),o=await h(t);return o&&Array.isArray(o.spirits)&&(o.spirits=b(o.spirits)),o}async function G(e,t,o=""){let a=`${f}/api/rankings?category=${encodeURIComponent(e)}&type=${encodeURIComponent(t)}`;return t==="stat"&&o&&(a+=`&statKey=${encodeURIComponent(o)}`),N(a,a)}async function W(){return C("soulExpTable",`${f}/api/soul/exp-table`)}async function K(e){const t=await fetch(`${f}/api/calculate/soul`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return h(t)}async function Z(){return C("chakData",`${f}/api/chak/data`)}async function Q(e){const t=await fetch(`${f}/api/calculate/chak`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return h(t)}const j={allSpirits:[]};function q(e){j.allSpirits=e}const T="loading-indicator-style";let c=null;function z(){if(document.getElementById(T))return;const e=document.createElement("style");e.id=T,e.textContent=`
        .loading-overlay {
            position: absolute; /* Changed from fixed to absolute for #app-container */
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 10000; backdrop-filter: blur(4px);
            opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s;
        }
        .loading-overlay.visible { opacity: 1; visibility: visible; }
        .loading-container {
            background-color: #ffffff; border-radius: 15px; padding: 30px;
            text-align: center; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 400px; width: 90%;
        }
        .loading-spinner {
            border: 5px solid #e0e0e0; width: 60px; height: 60px;
            border-radius: 50%; border-top-color: #3498db;
            margin: 0 auto 20px; animation: spin 1.2s linear infinite;
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .loading-text { margin: 15px 0; color: #333; font-size: 20px; font-weight: bold; }
        .loading-subtext { color: #666; font-size: 14px; margin-bottom: 5px; }
    `,document.head.appendChild(e)}function P(e,t="처리 중...",o="잠시만 기다려주세요."){if(!e){console.warn("Loading indicator container not provided.");return}c&&(c.remove(),c=null),z(),c=document.createElement("div"),c.className="loading-overlay",c.innerHTML=`
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">${t}</div>
            <div class="loading-subtext">${o}</div>
        </div>
    `,e.style.position="relative",e.appendChild(c),requestAnimationFrame(()=>{c?.classList.add("visible")})}function k(){c&&(c.classList.remove("visible"),c.remove(),c=null)}const J={spiritInfo:()=>y(()=>import("./spiritInfo-CMJvM171.js"),__vite__mapDeps([0,1,2,3,4])),bondCalculator:()=>y(()=>import("./bondCalculator-CAGFy_1G.js"),__vite__mapDeps([5,1,6,3,4])),spiritRanking:()=>y(()=>import("./spiritRanking-CIgYb4PX.js"),__vite__mapDeps([7,1,2,3,6])),soulCalculator:()=>y(()=>import("./soulCalculator-CvgnZBdK.js"),__vite__mapDeps([8,1])),chakCalculator:()=>y(()=>import("./chakCalculator-BBU37JJR.js"),__vite__mapDeps([9,1]))},u=document.getElementById("app-container"),_=document.getElementById("mainTabs");let S=null;const E=document.getElementById("helpBtn"),p=document.getElementById("helpTooltip"),$=document.getElementById("closeHelp"),L=document.getElementById("currentHelpTitle"),v=document.getElementById("pageSpecificHelpContent");E&&p&&$&&L&&v?(E.addEventListener("click",e=>{e.stopPropagation(),p.style.display=p.style.display==="block"?"none":"block",document.body.style.overflow=p.style.display==="block"?"hidden":"auto"}),$.addEventListener("click",e=>{e.stopPropagation(),p.style.display="none",document.body.style.overflow="auto"}),document.addEventListener("click",e=>{!E.contains(e.target)&&!p.contains(e.target)&&p.style.display==="block"&&(p.style.display="none",document.body.style.overflow="auto")})):console.error("Help button or related tooltip elements not found in DOM for initialization.");async function A(){const e=_.querySelector(".tab.active"),t=e?e.dataset.page:"spiritInfo",o=e?e.textContent:"환수 정보";if(S?.cleanup)try{S.cleanup(),console.log("[Router] Cleaned up previous page.")}catch(a){console.error("[Router] Error during page cleanup:",a)}u.innerHTML="",P(u,"페이지 로딩 중...","필요한 모듈을 불러오고 있습니다...");try{const a=J[t];if(!a)throw new Error(`'${t}' 페이지를 찾을 수 없습니다.`);const n=await a();if(S=n,n.init){if(await n.init(u),console.log(`[Router] Initialized page: ${t}`),L&&v?(L.textContent=`${o} 도움말`,n.getHelpContentHTML?v.innerHTML=n.getHelpContentHTML():v.innerHTML='<div class="content-block"><p class="text-center text-light mt-md">이 페이지에 대한 특정 도움말은 없습니다.</p></div>'):console.error("Help tooltip specific content elements not found for update within route()."),typeof gtag=="function"){const r=`/bayeon-hwayeon/${t}`;document.title=`바연화연 | ${o}`,gtag("event","page_view",{page_title:o,page_path:r}),console.log(`[GA4] Page view event sent for: ${r}`)}}else console.warn(`Page module '${t}' does not have an init() function.`),u.innerHTML='<p class="error-message">페이지를 초기화할 수 없습니다. (init 함수 없음)</p>'}catch(a){console.error(`[Router] Failed to load or initialize page '${t}':`,a),u.innerHTML=`<p class="error-message">페이지를 불러오는 중 오류가 발생했습니다: ${a.message}</p>`}finally{k()}}const I=document.querySelector(".footer-report-btn");I&&typeof gtag=="function"&&I.addEventListener("click",()=>{gtag("event","interaction",{event_category:"footer_action",event_label:"Report Button Click",event_action:"Click",link_url:"https://open.kakao.com/o/gZdiGDsh",page_location:window.location.href,page_title:document.title}),console.log("GA4: Report button click event sent.")});_.addEventListener("click",e=>{e.target.matches(".tab")&&!e.target.classList.contains("active")&&(_.querySelector(".tab.active")?.classList.remove("active"),e.target.classList.add("active"),A())});async function F(){P(u,"초기 데이터 로딩 중","서버에서 환수 정보를 불러오고 있습니다...");try{const t=(await U()).map(o=>{const a=o.image.replace(/^images\//,"assets/img/");return{...o,image:a}});q(t),await A()}catch(e){console.error("애플리케이션 초기화 실패:",e),u.innerHTML=`<p class="error-message">애플리케이션 초기화 실패: 데이터를 불러오는 데 실패했습니다. (${e.message})</p>`}finally{k()}}F();export{P as a,W as b,V as c,K as d,Z as e,G as f,Q as g,k as h,j as s};
