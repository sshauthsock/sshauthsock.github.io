import{s as J}from"./main-Bgn-9pGL.js";import{c as q,r as et,i as Q}from"./components-C2RsvHY9.js";import{L as nt}from"./utils-x5ORUUhl.js";import{e as z,p as e,h as Z}from"./myInfo-common-DGiNC5LG.js";import{c as F,g as it}from"./myInfo-engravingManager-Bl8avFnj.js";let L=null,B=null;function vt(){if(L){const n=L.querySelector(".my-info-spirit-popup-close");n?n.click():(L.remove(),L=null)}B&&(B.remove(),B=null)}let t={isPressed:!1,intervalId:null,timeoutId:null,hintElement:null,bridgeElement:null,hintHovered:!1,button:null,spirit:null,category:null,index:null,action:null,mouseDownTime:null,touchStartTime:null,touchMoveHandler:null,ignoreMouseUp:!1};function U(n){return(Array.isArray(J.allSpirits)?J.allSpirits:[]).filter(g=>g.type===n)}function ft(n,f,g){const i=z[`bondSlots${n}`];if(!i)return;i.innerHTML="";const o=e.bondSpirits[n]||[];for(let l=0;l<6;l++){const s=q("div","my-info-bond-slot");if(s.dataset.slotIndex=l,s.dataset.category=n,o[l]){const a=o[l];s.classList.add("filled");const y=e.activeSpirits[n];y&&y.name===a.name&&s.classList.add("used-spirit");const h=q("img");h.src=a.image,h.alt=a.name,h.onerror=()=>{if(h.src.endsWith(".webp")){const w=a.image.replace(/\.webp$/i,".jpg");h.src=w;return}e.imageLoadErrors.add(a.image),Z()},s.appendChild(h);const r=q("div");r.className="level-badge",r.style.position="absolute",r.style.bottom="1px",r.style.right="1px",r.style.background="rgba(0,0,0,0.7)",r.style.color="white",r.style.padding="1px 3px",r.style.borderRadius="2px",r.style.fontSize="9px",r.style.fontWeight="600",r.textContent=`Lv.${a.level||25}`,r.style.pointerEvents="none",s.appendChild(r);const I=e.engravingData[n]?.[a.name];if(I){const w=Array.isArray(I.registration)&&I.registration.length>0,b=I.bind&&Object.keys(I.bind).length>0;if(w||b){const m=q("div");m.className="engraving-badge",m.style.position="absolute",m.style.top="1px",m.style.right="1px",m.style.background="var(--color-primary)",m.style.color="white",m.style.padding="2px 4px",m.style.borderRadius="2px",m.style.fontSize="8px",m.style.fontWeight="700",m.textContent="각인",m.style.pointerEvents="none",m.style.zIndex="10",s.appendChild(m)}}}else s.textContent="+",s.style.fontSize="16px",s.style.color="var(--text-light)";s.addEventListener("click",a=>{a.target.classList.contains("remove-btn")||a.target.closest(".remove-btn")||(o[l]?g&&g(n,l,s,a):f&&f(n))}),i.appendChild(s)}}function mt(n){}function gt(n){const f=U(e.currentCategory);if(f.length===0){z.spiritGrid.innerHTML="<p class='text-center text-sm text-light mt-lg'>환수 데이터를 불러오는 중...</p>";return}const g=e.currentCategory,i=e.bondSpirits[g]||[],o=new Set(i.map(a=>a.name)),l=e.activeSpirits[g],s=l?l.name:null;et({container:z.spiritGrid,spirits:f,onSpiritClick:n,getSpiritState:a=>{const y=o.has(a.name),h=y&&s===a.name;return{selected:y,registrationCompleted:h,bondCompleted:!1,level25BindAvailable:!1}},groupByInfluence:!1})}function yt(n){e.currentCategory=n,z.spiritTabs.forEach(f=>{f.classList.toggle("active",f.dataset.category===n)})}function St(n,f,g,i,o){if(!n)return;const l=e.currentCategory,s=e.bondSpirits[l]||[],a=s.findIndex(y=>y.name===n.name);if(a!==-1)s.splice(a,1),e.bondSpirits[l]=s,e.isInitialLoad=!1,f&&f(l),g&&g(),e.lastTotalStatsHash=null,e.lastTotalStatsCalculation=null,e.lastSoulExpHash=null,e.lastSoulExpCalculation=null,i&&i(),o&&o();else if(s.length<6){s.push({...n,level:25}),e.bondSpirits[l]=s,e.isInitialLoad=!1;const y=s.length-1;f&&f(l);const h=z[`bondSlots${l}`];if(h){const r=h.children[y];r&&(r.classList.add("highlight"),setTimeout(()=>{r.classList.remove("highlight")},1e3))}g&&g(),e.lastTotalStatsHash=null,e.lastSoulExpHash=null,i&&i(),o&&o()}else{alert("결속 슬롯은 최대 6개까지 선택할 수 있습니다.");return}}function ht(n,f,g,i,o,l,s){const a=e.bondSpirits[n]||[],y=a[f],h=e.activeSpirits[n];h&&h.name===y.name&&(e.activeSpirits[n]=null),a.splice(f,1),e.bondSpirits[n]=a,g&&g(n),o&&o(),e.lastTotalStatsHash=null,e.lastTotalStatsCalculation=null,e.lastSoulExpHash=null,e.lastSoulExpCalculation=null,l&&l(),s&&s()}function M(n,f,g){const i=e.activeSpirits[f],o=i&&i.name===g.name,l=n.querySelector("[data-action='set-active']");l&&(o?(l.textContent="사용중",l.classList.add("active")):(l.textContent="사용하기",l.classList.remove("active")))}function ot(n){if(!t.button||!t.spirit||Q(t.spirit.name))return;t.isPressed=!0,t.ignoreMouseUp=!0,setTimeout(()=>{t.ignoreMouseUp=!1},100),at(n);const f=()=>{if(!t.isPressed||t.category===null||t.index===null)return!1;const i=(e.bondSpirits[t.category]||[])[t.index];if(!i)return!1;const o=i.level!==void 0&&i.level!==null?i.level:25;let l=!1;if(t.action==="level-down"&&o>0?(i.level=Math.max(0,o-1),l=!0):t.action==="level-up"&&o<25&&(i.level=Math.min(25,o+1),l=!0),l){const s=e.activeSpirits[t.category];s&&s.name===i.name&&(e.activeSpirits[t.category]={...s,level:i.level});const a=L?.querySelector(".level-input");return a&&(a.value=i.level),n?.renderBondSlots&&n.renderBondSlots(t.category),n?.updatePopupActiveState&&n.updatePopupActiveState(L,t.category,i),e.isInitialLoad=!1,e.lastTotalStatsHash=null,e.lastTotalStatsCalculation=null,e.lastSoulExpHash=null,e.lastSoulExpCalculation=null,n?.debouncedUpdateTotalStats&&n.debouncedUpdateTotalStats(),n?.debouncedUpdateSoulExp&&n.debouncedUpdateSoulExp(),!0}return!1};f(),t.intervalId=setInterval(()=>{f()||$()},200)}function $(){t.intervalId&&(clearInterval(t.intervalId),t.intervalId=null),t.timeoutId&&(clearTimeout(t.timeoutId),t.timeoutId=null),st(),t.touchMoveHandler&&(document.removeEventListener("touchmove",t.touchMoveHandler),t.touchMoveHandler=null),t.isPressed=!1,t.hintHovered=!1,t.bridgeElement=null,t.button=null,t.spirit=null,t.category=null,t.index=null,t.action=null,t.mouseDownTime=null,t.touchStartTime=null,t.ignoreMouseUp=!1}function at(n){if(!t.button)return;const g=(t.action==="level-down"?0:25).toString(),i=q("div","level-hint");i.textContent=g;const o=t.button.getBoundingClientRect();i.style.position="fixed",i.style.top=o.top+"px",i.style.zIndex="1001",i.style.color="white",i.style.padding="0px 4px",i.style.margin="0",i.style.border="none",i.style.borderRadius="3px",i.style.fontSize="10px",i.style.fontWeight="bold",i.style.pointerEvents="none",i.style.cursor="pointer",i.style.whiteSpace="nowrap",i.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)",i.style.textAlign="center",i.style.height=o.height+"px",i.style.lineHeight=o.height+"px",i.style.width="32px",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.transition="all 0.2s ease",t.action==="level-down"?(i.style.left=o.left-36+"px",i.style.backgroundColor="#f44336"):(i.style.left=o.right+4+"px",i.style.backgroundColor="#4CAF50"),document.body.appendChild(i),t.hintElement=i,t.hintHovered=!1;const l=q("div","hint-bridge");l.style.position="fixed",l.style.top=o.top+"px",l.style.height=o.height+"px",l.style.zIndex="1000",l.style.backgroundColor="transparent",l.style.pointerEvents="none",t.action==="level-down"?(l.style.left=o.left-36+"px",l.style.width=36+o.width+4+"px"):(l.style.left=o.left+"px",l.style.width=o.width+4+32+"px"),document.body.appendChild(l),t.bridgeElement=l;const s=()=>{t.isPressed&&(t.hintHovered=!0,i.style.transform="scale(1.2)",i.style.fontSize="12px",i.style.fontWeight="900",i.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)")},a=()=>{t.isPressed&&(t.hintHovered=!1,i.style.transform="scale(1)",i.style.fontSize="10px",i.style.fontWeight="bold",i.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)")},y=()=>{if(t.isPressed){if(t.hintHovered){const r=t.action==="level-down"?0:25;if(t.spirit){e.isInitialLoad=!1,t.spirit.level=r;const I=e.activeSpirits[t.category];I&&I.name===t.spirit.name&&(e.activeSpirits[t.category]={...I,level:r});const w=L?.querySelector(".level-input");w&&(w.value=r),n?.renderBondSlots&&n.renderBondSlots(t.category),n?.updatePopupActiveState&&n.updatePopupActiveState(L,t.category,t.spirit),e.lastTotalStatsHash=null,e.lastSoulExpHash=null,n?.debouncedUpdateTotalStats&&n.debouncedUpdateTotalStats(),n?.debouncedUpdateSoulExp&&n.debouncedUpdateSoulExp()}}$()}};i.addEventListener("mouseenter",s),i.addEventListener("mouseup",y),i.addEventListener("mouseleave",r=>{!l.contains(r.relatedTarget)&&r.relatedTarget!==l&&a()}),i.addEventListener("touchstart",r=>{r.preventDefault(),r.stopPropagation(),s()},{passive:!1}),i.addEventListener("touchend",r=>{r.preventDefault(),r.stopPropagation(),y()},{passive:!1}),l.addEventListener("mouseleave",r=>{!i.contains(r.relatedTarget)&&r.relatedTarget!==i&&a()}),l.addEventListener("touchstart",r=>{r.preventDefault(),r.stopPropagation(),s()},{passive:!1}),l.addEventListener("touchend",r=>{r.preventDefault(),r.stopPropagation()},{passive:!1});const h=r=>{if(!t.isPressed)return;const I=r.touches[0],w=document.elementFromPoint(I.clientX,I.clientY),b=t.hintElement,m=t.bridgeElement;if(!b)return;w===b||b.contains(w)||w===m?t.hintHovered||(b.style.pointerEvents="auto",m.style.pointerEvents="auto",t.hintHovered=!0,b.style.transform="scale(1.2)",b.style.fontSize="12px",b.style.fontWeight="900",b.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)"):t.hintHovered&&(b.style.pointerEvents="none",m.style.pointerEvents="none",t.hintHovered=!1,b.style.transform="scale(1)",b.style.fontSize="10px",b.style.fontWeight="bold",b.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)")};t.touchMoveHandler=h,document.addEventListener("touchmove",h,{passive:!1}),setTimeout(()=>{i&&t.isPressed&&(i.style.pointerEvents="auto"),l&&t.isPressed&&(l.style.pointerEvents="auto")},0)}function st(){t.hintElement&&(t.hintElement.remove(),t.hintElement=null),t.bridgeElement&&(t.bridgeElement.remove(),t.bridgeElement=null)}function xt(n,f,g,i,o){const s=(e.bondSpirits[n]||[])[f];if(!s)return;L&&(L.remove(),L=null),B&&(B.remove(),B=null);const a=q("div","my-info-spirit-popup"),y=q("div","my-info-spirit-popup-overlay");y.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(5px);
    z-index: 999;
  `,y.addEventListener("click",u=>{u.target===y&&(a.remove(),y.remove(),L=null,B=null)}),document.body.appendChild(y),B=y;const h=e.activeSpirits[n],r=h&&h.name===s.name,I=Q(s.name),w=e.engravingData[n]?.[s.name]||{},b=Array.isArray(w.registration)?w.registration.length:0;a.innerHTML=`
    <button class="my-info-spirit-popup-close">×</button>
    <div class="kakao-ad-popup-container desktop-popup-ad">
      <ins class="kakao_ad_area"
          data-ad-unit="DAN-aOM3JPGvOLhHlyoS"
          data-ad-width="728"
          data-ad-height="90"></ins>
    </div>
    <div class="kakao-ad-popup-container mobile-popup-ad">
      <ins class="kakao_ad_area"
          data-ad-unit="DAN-epbkjAaeHSxv0MYl"
          data-ad-width="320"
          data-ad-height="50"></ins>
    </div>
    <div class="my-info-spirit-popup-content">
      <div class="my-info-spirit-popup-header">
        <div style="display: flex; align-items: center; gap: var(--space-sm);">
          <img src="${s.image}" alt="${s.name}" loading="lazy">
          <div class="my-info-spirit-popup-name">${s.name}</div>
        </div>
        <div style="display: flex; align-items: center; justify-content: center; flex: 1;">
          <div class="spirit-level-control">
            ${I?`<div class="fixed-level-control">
                    <span class="fixed-level-label">레벨 25 (고정)</span>
                  </div>`:`<div style="display: flex; align-items: center; gap: 4px;">
                    <button class="level-btn minus-btn" data-action="level-down">-</button>
                    <input type="number" class="level-input" min="0" max="25" value="${s.level||25}">
                    <button class="level-btn plus-btn" data-action="level-up">+</button>
                  </div>`}
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: var(--space-xs);">
          <div class="my-info-spirit-popup-actions">
            <button class="my-info-spirit-popup-action-btn ${r?"active":""}" data-action="set-active">
              ${r?"사용중":"사용하기"}
            </button>
            <button class="my-info-spirit-popup-action-btn remove" data-action="remove">결속 제거</button>
          </div>
        </div>
      </div>
      <div class="my-info-engraving-tabs">
        <button class="my-info-engraving-tab active" data-tab="registration">등록효과</button>
        <button class="my-info-engraving-tab" data-tab="bind">장착효과</button>
      </div>
      <div class="my-info-engraving-tab-content active" id="registrationTab">
        <div id="registrationItemsContainer"></div>
        <div style="display: flex; gap: var(--space-sm); margin-top: var(--space-sm);">
          <button class="my-info-engraving-add-btn" id="addEngravingBtn" ${b>=4?"disabled":""}>
            + 등록효과 추가 (${b}/4)
          </button>
          <button class="my-info-engraving-save-btn" id="saveEngravingBtn">각인 저장</button>
        </div>
      </div>
      <div class="my-info-engraving-tab-content" id="bindTab">
        <div id="bindItemsContainer"></div>
        <div style="display: flex; gap: var(--space-sm); margin-top: var(--space-sm); justify-content: flex-end;">
          <button class="my-info-engraving-save-btn" id="saveEngravingBtnBind" style="flex: 0 1 50%; max-width: 50%;">각인 저장</button>
        </div>
      </div>
    </div>
  `,document.body.appendChild(a),L=a;const m=a.querySelector("img");m&&(m.onerror=()=>{e.imageLoadErrors.add(m.src),Z()}),setTimeout(()=>{try{const u=a.querySelector(".desktop-popup-ad .kakao_ad_area"),d=a.querySelector(".mobile-popup-ad .kakao_ad_area");window.adfit&&typeof window.adfit.render=="function"&&(u&&window.adfit.render(u),d&&window.adfit.render(d))}catch(u){nt.error("Kakao AdFit: Error rendering ads in popup:",u)}},100);const O=a.querySelector(".my-info-spirit-popup-close"),V={renderBondSlots:o?.renderBondSlots,updatePopupActiveState:M,debouncedUpdateTotalStats:o?.debouncedUpdateTotalStats,debouncedUpdateSoulExp:o?.debouncedUpdateSoulExp};if(!I){const u=a.querySelector(".level-input"),d=a.querySelector(".minus-btn"),v=a.querySelector(".plus-btn");u.focus(),u.select();const S=(c,p)=>{const E=x=>{x.preventDefault(),x.stopPropagation(),t.timeoutId&&clearTimeout(t.timeoutId),t.intervalId&&clearInterval(t.intervalId),t.isPressed=!1,t.button=c,t.spirit=s,t.category=n,t.index=f,t.action=p,t.hintHovered=!1,t.mouseDownTime=Date.now(),t.timeoutId=setTimeout(()=>{t.button===c&&ot(V)},300)},T=x=>{x.preventDefault(),x.stopPropagation(),t.touchStartTime=Date.now(),E(x)};c.addEventListener("mousedown",E),c.addEventListener("touchstart",T,{passive:!1})};S(d,"level-down"),S(v,"level-up"),u.addEventListener("change",()=>{let c=parseInt(u.value,10)||25;c<0&&(c=0),c>25&&(c=25),u.value=c,s.level=c;const p=e.activeSpirits[n];p&&p.name===s.name&&(e.activeSpirits[n]={...p,level:c}),o?.renderBondSlots&&o.renderBondSlots(n),M(a,n,s),e.isInitialLoad=!1,e.lastTotalStatsHash=null,e.lastTotalStatsCalculation=null,e.lastSoulExpHash=null,e.lastSoulExpCalculation=null,o?.debouncedUpdateTotalStats&&o.debouncedUpdateTotalStats(),o?.debouncedUpdateSoulExp&&o.debouncedUpdateSoulExp()})}const W=u=>{if(!t.ignoreMouseUp){if(t.timeoutId&&!t.isPressed){clearTimeout(t.timeoutId),t.timeoutId=null;const d=t.mouseDownTime?Date.now()-t.mouseDownTime:0;if(d>0&&d<300&&t.category!==null&&t.index!==null){const c=(e.bondSpirits[t.category]||[])[t.index];if(c){let p=c.level!==void 0&&c.level!==null?c.level:25,E=!1;if(t.action==="level-down"&&p>0?(p=Math.max(0,p-1),E=!0):t.action==="level-up"&&p<25&&(p=Math.min(25,p+1),E=!0),E){c.level=p;const T=e.activeSpirits[t.category];T&&T.name===c.name&&(e.activeSpirits[t.category]={...T,level:p});const x=a.querySelector(".level-input");x&&(x.value=p),e.isInitialLoad=!1,o?.renderBondSlots&&o.renderBondSlots(t.category),M(a,t.category,c),e.lastTotalStatsHash=null,e.lastTotalStatsCalculation=null,e.lastSoulExpHash=null,e.lastSoulExpCalculation=null,o?.debouncedUpdateTotalStats&&o.debouncedUpdateTotalStats(),o?.debouncedUpdateSoulExp&&o.debouncedUpdateSoulExp()}}}t.button=null,t.spirit=null,t.category=null,t.index=null,t.action=null,t.mouseDownTime=null;return}if(t.isPressed){if(u.type==="touchend"&&t.hintElement){const d=u.changedTouches?.[0]||u,v=t.hintElement.getBoundingClientRect();d.clientX>=v.left&&d.clientX<=v.right&&d.clientY>=v.top&&d.clientY<=v.bottom&&(t.hintHovered=!0)}if(t.hintHovered&&t.category!==null&&t.index!==null){const d=t.action==="level-down"?0:25,S=(e.bondSpirits[t.category]||[])[t.index];if(S){S.level=d;const c=e.activeSpirits[t.category];c&&c.name===S.name&&(e.activeSpirits[t.category]={...c,level:d});const p=a.querySelector(".level-input");p&&(p.value=d),o?.renderBondSlots&&o.renderBondSlots(t.category),M(a,t.category,S),e.lastTotalStatsHash=null,e.lastSoulExpHash=null,o?.debouncedUpdateTotalStats&&o.debouncedUpdateTotalStats(),o?.debouncedUpdateSoulExp&&o.debouncedUpdateSoulExp()}}$(),u.preventDefault(),u.stopPropagation();return}(t.button||t.timeoutId)&&(t.button=null,t.spirit=null,t.category=null,t.index=null,t.action=null,t.mouseDownTime=null,t.touchStartTime=null,t.timeoutId&&(clearTimeout(t.timeoutId),t.timeoutId=null))}},_=u=>{const d=u.changedTouches[0],v={...u,type:"touchend",clientX:d.clientX,clientY:d.clientY,changedTouches:[d]};W(v)};document.addEventListener("mouseup",W),document.addEventListener("touchend",_,{passive:!1});const j=()=>{$(),document.removeEventListener("mouseup",W),document.removeEventListener("touchend",_),a.remove(),B&&(B.remove(),B=null),L=null};O.addEventListener("click",j);const P=a.querySelector("[data-action='set-active']");P.addEventListener("click",()=>{e.activeSpirits[n];const u=e.activeSpirits[n];if(u&&u.name===s.name)e.activeSpirits[n]=null,P.textContent="사용하기",P.classList.remove("active");else{const d=I?25:parseInt(a.querySelector(".level-input")?.value,10)||s.level||25,v={name:s.name,level:d,...s};v.level=d,e.activeSpirits[n]=v,s.level=d,P.textContent="사용중",P.classList.add("active"),P.textContent="사용중",P.classList.add("active")}e.isInitialLoad=!1,o?.renderBondSlots&&o.renderBondSlots(n),M(a,n,s),e.lastTotalStatsHash=null,e.lastTotalStatsCalculation=null,e.lastSoulExpHash=null,e.lastSoulExpCalculation=null,o?.updateTotalStats&&o.updateTotalStats(U,o.updateStatItemsWithValues),o?.updateSoulExp&&o.updateSoulExp(U)}),a.querySelector("[data-action='remove']").addEventListener("click",()=>{$(),o?.removeBondSpirit&&o.removeBondSpirit(n,f),j()});const H=a.querySelector("#registrationItemsContainer"),D=a.querySelector("#bindItemsContainer"),C=a.querySelector("#addEngravingBtn"),G=a.querySelector("#saveEngravingBtn"),N=a.querySelector("#saveEngravingBtnBind"),K=a.querySelectorAll(".my-info-engraving-tab"),Y=a.querySelectorAll(".my-info-engraving-tab-content");function X(){return it(n,s.name)}function k(){if(!H)return;H.innerHTML="";const{registrationItems:u}=X();if(u.forEach((d,v)=>{const S=d.statKey||"",c=d.value||"",p=F(S,c,"","registration",v,()=>A(),E=>{if(E.remove(),C){const T=H.querySelectorAll('.my-info-engraving-item[data-type="registration"]').length;C.disabled=T>=4,C.textContent=`+ 등록효과 추가 (${T}/4)`}A()});H.appendChild(p)}),C){const d=u.length;C.disabled=d>=4,C.textContent=`+ 등록효과 추가 (${d}/4)`}}function A(){if(!D)return;D.innerHTML="";const u=H.querySelectorAll('.my-info-engraving-item[data-type="registration"]'),d=new Set;u.forEach(S=>{const p=S.querySelector(".my-info-engraving-stat-select")?.value||"";p&&d.add(p)});const{bindStats:v}=X();d.forEach(S=>{const c=v[S]||"",p=F(S,"",c,"bind");D.appendChild(p)})}function tt(){k(),A()}K&&Y&&K.forEach(u=>{u.addEventListener("click",()=>{const d=u.dataset.tab;K.forEach(v=>v.classList.remove("active")),u.classList.add("active"),Y.forEach(v=>{v.classList.remove("active"),v.id===`${d}Tab`&&v.classList.add("active")})})}),tt(),C&&C.addEventListener("click",()=>{if(H.querySelectorAll('.my-info-engraving-item[data-type="registration"]').length>=4)return;const d=F("","","","registration",null,()=>A(),v=>{if(v.remove(),C){const S=H.querySelectorAll('.my-info-engraving-item[data-type="registration"]').length;C.disabled=S>=4,C.textContent=`+ 등록효과 추가 (${S}/4)`}A()});if(H.appendChild(d),A(),C){const v=H.querySelectorAll('.my-info-engraving-item[data-type="registration"]').length;C.disabled=v>=4,C.textContent=`+ 등록효과 추가 (${v}/4)`}}),G&&G.addEventListener("click",()=>{const u=[],d={};H.querySelectorAll('.my-info-engraving-item[data-type="registration"]').forEach(p=>{const E=p.querySelector(".my-info-engraving-stat-select"),T=p.querySelector(".my-info-engraving-value-input"),x=E.value,R=parseFloat(T.value)||0;x&&u.push({statKey:x,value:R})}),D.querySelectorAll('.my-info-engraving-item[data-type="bind"]').forEach(p=>{const E=p.dataset.statKey;if(!E)return;const T=p.querySelector(".my-info-engraving-value-input"),x=parseFloat(T.value)||0;d[E]=x});const c={registration:u,bind:d};e.engravingData[n]||(e.engravingData[n]={}),e.engravingData[n][s.name]=c,e.isInitialLoad=!1,o?.updateTotalStats&&o.updateTotalStats(U,o.updateStatItemsWithValues),o?.renderBondSlots&&o.renderBondSlots(n)}),N&&N.addEventListener("click",()=>{const u=[],d={};H.querySelectorAll('.my-info-engraving-item[data-type="registration"]').forEach(p=>{const E=p.querySelector(".my-info-engraving-stat-select"),T=p.querySelector(".my-info-engraving-value-input"),x=E.value,R=parseFloat(T.value)||0;x&&u.push({statKey:x,value:R})}),D.querySelectorAll('.my-info-engraving-item[data-type="bind"]').forEach(p=>{const E=p.dataset.statKey;if(!E)return;const T=p.querySelector(".my-info-engraving-value-input"),x=parseFloat(T.value)||0;d[E]=x});const c={registration:u,bind:d};e.engravingData[n]||(e.engravingData[n]={}),e.engravingData[n][s.name]=c,e.isInitialLoad=!1,o?.updateTotalStats&&o.updateTotalStats(U,o.updateStatItemsWithValues),o?.renderBondSlots&&o.renderBondSlots(n)})}export{gt as a,yt as b,mt as c,$ as d,ht as e,vt as f,U as g,St as h,ft as r,xt as s};
