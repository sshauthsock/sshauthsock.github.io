class l{static handle(e,r=""){const n={message:e.message||"알 수 없는 오류가 발생했습니다.",context:r,timestamp:new Date().toISOString()};return typeof gtag=="function"&&gtag("event","exception",{description:n.message,fatal:!1}),n}static showUserFriendlyMessage(e,r){const n=this.handle(e),o=this.getUserFriendlyMessage(n.message);r&&(r.innerHTML=`
        <div class="error-message">
          <h3>오류가 발생했습니다</h3>
          <p>${o}</p>
          <button onclick="location.reload()">새로고침</button>
        </div>
      `)}static getUserFriendlyMessage(e){const r=["Failed to fetch","NetworkError","Network request failed","ERR_INTERNET_DISCONNECTED","ERR_NETWORK_CHANGED","ERR_CONNECTION_REFUSED","ERR_CONNECTION_TIMED_OUT","ERR_CONNECTION_RESET","Failed to fetch dynamically imported module","dynamically imported module"];for(const n of r)if(e.includes(n))return"현재 서버 점검중 입니다.";return e.includes("timeout")?"요청 시간이 초과되었습니다. 다시 시도해주세요.":"일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요."}}class u{constructor(e=50){this.cache=new Map,this.maxSize=e}get(e){if(this.cache.has(e)){const r=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,r),r}return null}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,r)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}size(){return this.cache.size}has(e){return this.cache.has(e)}}const m=new u(50);class s{static isDev(){return!1}static log(...e){this.isDev()&&console.log(...e)}static error(...e){console.error(...e)}static warn(...e){this.isDev()&&console.warn(...e)}static info(...e){this.isDev()&&console.info(...e)}static debug(...e){this.isDev()&&console.debug(...e)}static group(...e){this.isDev()&&console.group(...e)}static groupEnd(){this.isDev()&&console.groupEnd()}static logIf(e,...r){this.isDev()&&e&&console.log(...r)}}class p{static getMaxSize(){return 5*1024*1024}static getUsedSize(){let e=0;for(let r in sessionStorage)sessionStorage.hasOwnProperty(r)&&(e+=sessionStorage[r].length+r.length);return e}static canStore(e){return this.getUsedSize()+e<this.getMaxSize()}static setItem(e,r){const n=new Blob([r]).size;if(!this.canStore(n))for(s.warn(`[Storage] Storage nearly full (${(this.getUsedSize()/1024/1024).toFixed(2)}MB used). Clearing oldest items...`);!this.canStore(n)&&sessionStorage.length>0;)this.clearOldest();try{return sessionStorage.setItem(e,r),!0}catch(o){if(s.error(`[Storage] Failed to store ${e}:`,o),sessionStorage.length>0){this.clearOldest();try{return sessionStorage.setItem(e,r),!0}catch(c){return s.error(`[Storage] Retry failed for ${e}:`,c),!1}}return!1}}static clearOldest(){if(sessionStorage.length===0)return;const e=sessionStorage.key(0);e&&(sessionStorage.removeItem(e),s.log(`[Storage] Removed oldest item: ${e}`))}static getItem(e){return sessionStorage.getItem(e)}static removeItem(e){sessionStorage.removeItem(e)}static clear(){sessionStorage.clear()}static getItemCount(){return sessionStorage.length}static getUsageRatio(){return this.getUsedSize()/this.getMaxSize()}}const a=new Map;function g(t){if(!t||typeof t!="string")return t;if(a.has(t))return a.get(t);const e=t.replace(/^images\//,"assets/img/");return a.set(t,e),e}function d(t){return!t||typeof t.image!="string"?t:{...t,image:g(t.image)}}function v(t){return Array.isArray(t)?t.map(d):t}function y(t,e,r=!0){typeof gtag=="function"&&gtag("event","api_performance",{event_category:"API",event_label:t,value:Math.round(e),success:r,api_endpoint:t,response_time_ms:Math.round(e)})}function E(t,e,r={}){typeof gtag=="function"&&gtag("event","calculation_performance",{event_category:"Calculation",event_label:t,value:Math.round(e),calculation_type:t,duration_ms:Math.round(e),...r})}function _(t,e,r={}){typeof gtag=="function"&&gtag("event","user_action",{event_category:e,event_label:t,action:t,category:e,...r})}function S(t,e){typeof gtag=="function"&&gtag("event","page_load_performance",{event_category:"Page Load",event_label:t,value:Math.round(e),page_name:t,load_time_ms:Math.round(e)})}function f(){if(typeof gtag=="function"){if("PerformanceObserver"in window){try{new PerformanceObserver(e=>{const r=e.getEntries(),n=r[r.length-1];gtag("event","web_vitals",{event_category:"Web Vitals",event_label:"LCP",value:Math.round(n.renderTime||n.loadTime),metric_name:"LCP",metric_value:Math.round(n.renderTime||n.loadTime)})}).observe({entryTypes:["largest-contentful-paint"]})}catch{}try{new PerformanceObserver(e=>{e.getEntries().forEach(n=>{gtag("event","web_vitals",{event_category:"Web Vitals",event_label:"FID",value:Math.round(n.processingStart-n.startTime),metric_name:"FID",metric_value:Math.round(n.processingStart-n.startTime)})})}).observe({entryTypes:["first-input"]})}catch{}try{let t=0;new PerformanceObserver(r=>{r.getEntries().forEach(o=>{o.hadRecentInput||(t+=o.value)}),gtag("event","web_vitals",{event_category:"Web Vitals",event_label:"CLS",value:Math.round(t*1e3),metric_name:"CLS",metric_value:t})}).observe({entryTypes:["layout-shift"]})}catch{}}window.addEventListener("load",()=>{if(window.performance&&window.performance.timing){const t=window.performance.timing,e=t.loadEventEnd-t.navigationStart;gtag("event","page_load",{event_category:"Performance",event_label:"Page Load",value:Math.round(e),load_time_ms:Math.round(e),dom_content_loaded:t.domContentLoadedEventEnd-t.navigationStart,dom_complete:t.domComplete-t.navigationStart})}})}}function w(){f()}class h{constructor(){this.errorCount=0,this.maxErrors=5,this.errorResetTime=6e4,this.lastErrorTime=null}init(){window.addEventListener("error",e=>{this.handleError(e.error||new Error(e.message),{filename:e.filename,lineno:e.lineno,colno:e.colno,type:"window_error"})}),window.addEventListener("unhandledrejection",e=>{const r=e.reason instanceof Error?e.reason:new Error(String(e.reason));this.handleError(r,{type:"unhandled_promise_rejection",promise:e.promise}),e.preventDefault()}),window.addEventListener("rejectionhandled",e=>{s.log("[ErrorBoundary] Promise rejection was handled:",e.reason)}),s.log("[ErrorBoundary] Error boundary initialized")}handleError(e,r={}){const n=Date.now();if(this.lastErrorTime&&n-this.lastErrorTime>this.errorResetTime&&(this.errorCount=0),this.lastErrorTime=n,this.errorCount++,this.errorCount>this.maxErrors){s.error(`[ErrorBoundary] Too many errors (${this.errorCount}). Preventing further error handling.`);return}const o={message:e.message||"알 수 없는 오류",stack:e.stack,name:e.name,...r,timestamp:new Date().toISOString(),errorCount:this.errorCount};return l.handle(e,`ErrorBoundary: ${r.type||"unknown"}`),typeof gtag=="function"&&gtag("event","exception",{description:o.message,fatal:!0,error_type:r.type||"unknown",error_count:this.errorCount}),o}safeExecute(e,r="unknown",n=null){try{return e()}catch(o){return this.handleError(o,{type:"safe_execute",context:r}),n&&typeof n=="function"?n(o):null}}async safeExecuteAsync(e,r="unknown",n=null){try{return await e()}catch(o){return this.handleError(o,{type:"safe_execute_async",context:r}),n&&typeof n=="function"?await n(o):null}}resetErrorCount(){this.errorCount=0,this.lastErrorTime=null,s.log("[ErrorBoundary] Error count reset")}}const b=new h;function C(t){t.querySelector(".modal-support-banner")}window.closeSupportBanner=function(){const t=document.getElementById("modalSupportBanner");t&&(t.style.animation="supportBannerSlideOut 0.3s ease-in",setTimeout(()=>{t.remove()},300))};const i=document.createElement("style");i.textContent=`
  @keyframes supportBannerSlideOut {
    from {
      opacity: 1;
      transform: translateY(0);
    }
    to {
      opacity: 0;
      transform: translateY(-10px);
    }
  }
`;document.head.appendChild(i);export{l as E,s as L,p as S,C as a,v as b,S as c,_ as d,b as e,E as f,w as i,m,y as t};
