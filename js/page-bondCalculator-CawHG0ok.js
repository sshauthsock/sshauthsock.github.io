import{s as w,a as be,u as _,c as Se,h as ye}from"./main-B1ZbE8A-.js";import{c as E,i as I,e as S,S as W,F as Le,P as q,a as Ce,b as Ee,r as He,d as Be}from"./components-B1GG1ywu.js";import{L as k,a as Ie,l as K,n as ee,E as te}from"./utils-DIa4fKeE.js";const le="savedOptimalCombinations",se="combinationCounter",Me=5;function U(){try{const n=localStorage.getItem(le),t=n?JSON.parse(n):{ìˆ˜í˜¸:[],íƒ‘ìŠ¹:[],ë³€ì‹ :[]};return t.ìˆ˜í˜¸||(t.ìˆ˜í˜¸=[]),t.íƒ‘ìŠ¹||(t.íƒ‘ìŠ¹=[]),t.ë³€ì‹ ||(t.ë³€ì‹ =[]),t}catch(n){return console.error("Failed to load history from localStorage:",n),{ìˆ˜í˜¸:[],íƒ‘ìŠ¹:[],ë³€ì‹ :[]}}}function ae(){try{const n=localStorage.getItem(se),t=n?JSON.parse(n):{ìˆ˜í˜¸:0,íƒ‘ìŠ¹:0,ë³€ì‹ :0};return t.ìˆ˜í˜¸===void 0&&(t.ìˆ˜í˜¸=0),t.íƒ‘ìŠ¹===void 0&&(t.íƒ‘ìŠ¹=0),t.ë³€ì‹ ===void 0&&(t.ë³€ì‹ =0),t}catch(n){return console.error("Failed to load counter from localStorage:",n),{ìˆ˜í˜¸:0,íƒ‘ìŠ¹:0,ë³€ì‹ :0}}}function oe(n,t){try{localStorage.setItem(le,JSON.stringify(n)),localStorage.setItem(se,JSON.stringify(t))}catch(e){console.error("ê¸°ë¡ ì €ì¥ ì‹¤íŒ¨:",e),alert("ì¡°í•© ê¸°ë¡ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")}}function re(n){if(!n||!n.spirits||n.spirits.length===0||!n.spirits[0].type){console.warn("Invalid result data provided to addResult:",n);return}const t=n.spirits[0].type;if(!["ìˆ˜í˜¸","íƒ‘ìŠ¹","ë³€ì‹ "].includes(t)){console.warn(`Invalid category '${t}' for history storage.`);return}const e=U(),i=ae();i[t]===void 0&&(i[t]=0);const l=new Date,a={...n,timestamp:l.toLocaleString("sv-SE"),id:l.getTime()};let r=-1;for(let o=0;o<Me;o++)if(!e[t][o]){r=o;break}r===-1&&(r=e[t].map((d,u)=>({entry:d,index:u})).filter(({entry:d})=>d!==null).reduce((d,u)=>!d||u.entry.id<d.entry.id?u:d,null)?.index||0),e[t][r]=a,i[t]++,oe(e,i)}function Te(n,t){const e=U(),i=ae();if(!e[n])return console.warn(`Attempted to remove from unknown category: ${n}`),!1;const l=e[n].findIndex(a=>a&&a.id===t);return l===-1?(console.warn(`Entry with id ${t} not found in category ${n}`),!1):(e[n][l]=null,oe(e,i),!0)}function ce(n){const t=U();if(!t[n])return console.warn(`Attempted to retrieve history for unknown category: ${n}`),[];const e=t[n].filter(Boolean);return e.sort((i,l)=>l.id-i.id),e}let A=null,y=null,C=null,g=[],c={isPressed:!1,intervalId:null,timeoutId:null,hintElement:null,bridgeElement:null,hintHovered:!1,button:null,spiritName:null,action:null,mouseDownTime:null};const V={damageResistance:"stat-damage-resistance",damageResistancePenetration:"stat-damage-resistance-penetration",pvpDefensePercent:"stat-pvp-defense-percent",pvpDamagePercent:"stat-pvp-damage-percent"},xe=["damageResistance","damageResistancePenetration","pvpDamagePercent","pvpDefensePercent"];function Y(n,t){if(!n)return{spiritName:null,stats:[],totalScore:0};const e=w.allSpirits.find(o=>o.name===n);if(!e)return{spiritName:n,stats:[],totalScore:0};const l=e.stats.find(o=>o.level===t)?.registrationStat||{};let a=0;const r=[];return Object.entries(l).forEach(([o,d])=>{const u=S(d),v=W[o]||o;o==="damageResistance"||o==="damageResistancePenetration"?a+=u:(o==="pvpDamagePercent"||o==="pvpDefensePercent")&&(a+=u*10),u>0&&r.push({key:o,name:v,value:u,isScoreContributing:xe.includes(o)})}),{spiritName:n,stats:r,totalScore:Math.round(a)}}function j(n){let t=0;const e={};return n.forEach(i=>{const l=w.allSpirits.find(a=>a.name===i.name&&a.type===i.type);if(l){const a=l.stats.find(r=>r.level===i.stats[0].level);a?.bindStat&&Object.entries(a.bindStat).forEach(([r,o])=>{const d=S(o);e[r]=(e[r]||0)+d,r==="damageResistance"||r==="damageResistancePenetration"?t+=d:(r==="pvpDamagePercent"||r==="pvpDefensePercent")&&(t+=d*10)})}}),{bindScore:t,bindStats:Object.entries(e).filter(([,i])=>i>0).map(([i,l])=>({key:i,name:W[i]||i,value:l}))}}function R(n,t,e,i,l={}){const a=document.getElementById(n);if(!a)return;let r="";l.gradeCounts?r=Object.entries(l.gradeCounts).filter(([,u])=>u>=2).map(([u,v])=>`<span class="grade-tag grade-tag-${u==="ì „ì„¤"?"legend":"immortal"}">${u}x${v}</span>`).join(" "):l.factionCounts&&(r=Object.entries(l.factionCounts).filter(([,u])=>u>=2).map(([u,v])=>{const b=Le[u]||"";return`<span class="faction-tag" title="${u}"><img src="${b}" class="faction-icon" alt="${u}">x${v}</span>`}).join(" "));const o=Array.isArray(e)?e:[];let d='<p class="no-effects">íš¨ê³¼ ì—†ìŒ</p>';o.length>0&&(d=`<ul class="effects-list">${o.map(u=>{const b=q.includes(u.key)?`${S(u.value)}%`:S(u.value).toLocaleString();return`<li class="${V[u.key]||""}"><span class="stat-name">${u.name}</span><span class="stat-value">${b}</span></li>`}).join("")}</ul>`),a.innerHTML=`
        <h4>${t} <span class="section-score">${Math.round(S(i))}</span></h4>
        ${r?`<div class="set-info">${r}</div>`:""}
        <div class="effects-content">${d}</div>
    `}function we(){O();const n=E("div","modal-overlay",{id:"optimalModal"}),t=E("div","modal-content",{id:"optimalModalContent"}),e=E("button","modal-close",{id:"closeOptimalModal",text:"âœ•"});t.appendChild(e),n.appendChild(t),document.body.appendChild(n),e.onclick=O,n.addEventListener("click",l=>{l.target===n&&O()});const i=l=>{l.key==="Escape"&&O()};return document.addEventListener("keydown",i),n._escListener=i,A=n,{modal:n,content:t}}function de(){const n=document.getElementById("registrationEffectSection");if(!n)return;if(!y){n.style.display="none";return}const t=g.find(r=>r.name===y),e=t?t.stats[0].level:25,i=Y(y,e);if(i.stats.length===0){n.innerHTML=`
      <h4>ë“±ë¡ íš¨ê³¼ <span class="section-score">0</span></h4>
      <div class="set-info">
        <span class="registration-spirit-tag">ì‚¬ìš©ì¤‘: ${y}</span>
      </div>
      <div class="effects-content">
        <p class="no-effects">ë“±ë¡ íš¨ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
    `,n.style.display="block";return}const a=`<ul class="effects-list">${i.stats.map(r=>{const d=q.includes(r.key)?`${r.value}%`:r.value.toLocaleString();return`<li class="${V[r.key]||""}"><span class="stat-name">${r.name}</span><span class="stat-value">${d}</span></li>`}).join("")}</ul>`;n.innerHTML=`
    <h4>ë“±ë¡ íš¨ê³¼ <span class="section-score">${i.totalScore}</span></h4>
    <div class="set-info">
      <span class="registration-spirit-tag">ì‚¬ìš©ì¤‘: ${y}</span>
    </div>
    <div class="effects-content">
      ${a}
    </div>
  `,n.style.display="block"}function ue(){const n=document.getElementById("hiddenRegistrationStats"),t=document.querySelector(".more-stats-button");if(n&&t)if(n.style.display==="none"){n.style.display="block";const e=n.querySelectorAll("li").length;t.textContent=`${e}ê°œ ìˆ¨ê¸°ê¸°`}else{n.style.display="none";const e=n.querySelectorAll("li").length;t.textContent=`+${e}ê°œ ë” ë³´ê¸°`}}function P(){if(!C)return;g.forEach((L,T)=>{});const n=j(g),t=S(C.gradeScore),e=S(C.factionScore),i=Math.round(t+e+n.bindScore),l=g.find(L=>L.name===y),a=l?l.stats[0].level:25,o=Y(y,a).totalScore,d=i+o;o>0?`${d.toLocaleString()}${i.toLocaleString()}`:`${i.toLocaleString()}`;let u,v;o>0?(u=`ì¡°í•© í•©ì‚°: ${d.toLocaleString()} (${i.toLocaleString()})`,v="í•©ì‚° = ë“±ë¡ íš¨ê³¼ + ê²°ì† í•©ì‚° (ë“±ê¸‰ íš¨ê³¼ + ì„¸ë ¥ íš¨ê³¼ + ê²°ì† íš¨ê³¼)<br>í”¼í•´ì €í•­ê´€í†µ + í”¼í•´ì €í•­ + (ëŒ€ì¸í”¼í•´% Ã— 10) + (ëŒ€ì¸ë°©ì–´% Ã— 10)"):(u=`ì¡°í•© í•©ì‚°: ${i.toLocaleString()}`,v="í•©ì‚° = ê²°ì† í•©ì‚° (ë“±ê¸‰ íš¨ê³¼ + ì„¸ë ¥ íš¨ê³¼ + ê²°ì† íš¨ê³¼)<br>í”¼í•´ì €í•­ê´€í†µ + í”¼í•´ì €í•­ + (ëŒ€ì¸í”¼í•´% Ã— 10) + (ëŒ€ì¸ë°©ì–´% Ã— 10)");const b=document.getElementById("optimalHeader");if(b){const L=b.querySelector(".modal-main-title");L&&(L.innerHTML=`
        ${u}
        <span class="score-formula">${v}</span>
      `)}R("optimalBindEffects","ê²°ì† íš¨ê³¼",n.bindStats,n.bindScore),de(),ve(g),window.toggleMoreStats=ue}function ke(){if(!C||!g||g.length===0){alert("ì €ì¥í•  ì¡°í•© ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const n=j(g),t=S(C.gradeScore),e=S(C.factionScore),i=g.find(u=>u.name===y),l=i?i.stats[0].level:25,r=Y(y,l).totalScore,o=Math.round(t+e+n.bindScore+r),d={...C,spirits:g.map(u=>({...u,stats:[{level:u.stats[0].level}]})),bindScore:n.bindScore,bindStats:n.bindStats,gradeScore:t,factionScore:e,scoreWithBind:Math.round(t+e+n.bindScore),registrationScore:r,totalScoreWithRegistration:o,selectedUsedSpirit:y,combination:g.map(u=>u.name),timestamp:new Date().toLocaleString("sv-SE"),id:Date.now()};re(d),alert("ì¡°í•©ì´ ê¸°ë¡ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!"),setTimeout(()=>{g[0]?.type&&z(g[0].type)},100)}function $e(n,t,e){if(e.stopPropagation(),confirm("ì´ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))if(Te(n,t)){const l=ce(n);if(C&&C.id===t)if(l.length>0){const a=l[0];y=a.selectedUsedSpirit||null,C=JSON.parse(JSON.stringify(a)),g=JSON.parse(JSON.stringify(a.spirits)),X(a,!1)}else{y=null,C=null,g=[];const a=document.getElementById("optimalHeader");a&&(a.innerHTML=`
              <div class="optimal-header-left">
                <h3 class="modal-main-title">ì¡°í•© í•©ì‚°: ì €ì¥ëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</h3>
              </div>
              <div class="optimal-header-right">
                <button class="header-save-button" onclick="saveCombination()">ì¡°í•© ì €ì¥</button>
              </div>
            `);const r=document.getElementById("combinationResultsContainer");r&&(r.innerHTML='<p class="no-data-message">ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>')}z(n)}else alert("ê¸°ë¡ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}function pe(n){const t=n.target;if(!t.classList.contains("level-btn"))return;const e=t.dataset.action;if(e!=="level-down"&&e!=="level-up")return;n.preventDefault(),n.stopPropagation();const i=t.dataset.spirit;i&&(c.timeoutId&&clearTimeout(c.timeoutId),c.intervalId&&clearInterval(c.intervalId),c.isPressed=!1,c.button=t,c.spiritName=i,c.action=e,c.hintHovered=!1,c.mouseDownTime=Date.now(),c.timeoutId=setTimeout(()=>{c.button===t&&Ae()},300))}function Pe(n){n.touches[0],pe({target:n.target,preventDefault:()=>n.preventDefault(),stopPropagation:()=>n.stopPropagation()})}function Ne(n){const t=n.changedTouches[0],e={target:document.elementFromPoint(t.clientX,t.clientY),clientX:t.clientX,clientY:t.clientY,type:"touchend"};J(e)}function Ae(){if(!c.button)return;c.isPressed=!0;try{De()}catch(t){k.error("createModalHint ì—ëŸ¬:",t)}const n=()=>{if(!c.isPressed)return!1;const t=g.findIndex(l=>l.name===c.spiritName);if(t===-1||I(c.spiritName))return!1;const e=g[t];e.stats[0].level;let i=!1;if(c.action==="level-down"&&e.stats[0].level>0?(e.stats[0].level=Math.max(0,e.stats[0].level-1),i=!0):c.action==="level-up"&&e.stats[0].level<25&&(e.stats[0].level=Math.min(25,e.stats[0].level+1),i=!0),i){const l=c.button.closest(".spirit-info-item-with-level").querySelector(".spirit-info-level");l&&(l.textContent=`Lv.${e.stats[0].level}`);const a=c.button.closest(".spirit-info-item-with-level").querySelector(".level-input");return a&&(a.value=e.stats[0].level),P(),!0}return!1};n(),c.intervalId=setInterval(()=>{n()||F()},200)}function F(){c.intervalId&&(clearInterval(c.intervalId),c.intervalId=null),c.timeoutId&&(clearTimeout(c.timeoutId),c.timeoutId=null),Oe(),c.isPressed=!1,c.hintHovered=!1,c.bridgeElement=null,c.button=null,c.spiritName=null,c.action=null,c.mouseDownTime=null}function De(){if(!c.button)return;const t=(c.action==="level-down"?0:25).toString(),e=document.createElement("div");e.className="level-hint",e.textContent=t;const i=c.button.getBoundingClientRect();e.style.position="fixed",e.style.top=i.top+"px",e.style.zIndex="2100",e.style.color="white",e.style.padding="0px 4px",e.style.margin="0",e.style.border="none",e.style.borderRadius="3px",e.style.fontSize="10px",e.style.fontWeight="bold",e.style.pointerEvents="auto",e.style.cursor="pointer",e.style.whiteSpace="nowrap",e.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)",e.style.textAlign="center",e.style.height=i.height+"px",e.style.width="30px",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.transition="all 0.2s ease",c.action==="level-down"?(e.style.left=i.left-30+"px",e.style.backgroundColor="#f44336"):(e.style.left=i.right+"px",e.style.backgroundColor="#4CAF50"),e.style.lineHeight=i.height+"px",document.body.appendChild(e),c.hintElement=e,c.hintHovered=!1;const l=document.createElement("div");l.className="hint-bridge",l.style.position="fixed",l.style.top=i.top+"px",l.style.height=i.height+"px",l.style.zIndex="2099",l.style.backgroundColor="transparent",l.style.pointerEvents="auto",c.action==="level-down"?(l.style.left=i.left-35+"px",l.style.width=35+i.width+"px"):(l.style.left=i.left+"px",l.style.width=i.width+35+"px"),document.body.appendChild(l),c.bridgeElement=l;const a=()=>{c.isPressed&&(c.hintHovered=!0,e.style.transform="scale(1.2)",e.style.fontSize="12px",e.style.fontWeight="900",e.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)")},r=()=>{c.isPressed&&(c.hintHovered=!1,e.style.transform="scale(1)",e.style.fontSize="10px",e.style.fontWeight="bold",e.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)")},o=()=>{if(c.isPressed&&c.hintHovered){const d=c.action==="level-down"?0:25,u=g.findIndex(v=>v.name===c.spiritName);if(u!==-1){g[u].stats[0].level=d;const v=c.button.closest(".spirit-info-item-with-level").querySelector(".spirit-info-level");v&&(v.textContent=`Lv.${d}`);const b=c.button.closest(".spirit-info-item-with-level").querySelector(".level-input");b&&(b.value=d),P()}F()}};e.addEventListener("mouseenter",a),e.addEventListener("mouseup",o),e.addEventListener("mouseleave",r),e.addEventListener("touchstart",d=>{d.preventDefault(),a()},{passive:!1}),e.addEventListener("touchend",d=>{d.preventDefault(),o()},{passive:!1}),l.addEventListener("touchstart",d=>{d.preventDefault(),a()},{passive:!1}),l.addEventListener("touchend",d=>{d.preventDefault()},{passive:!1})}function Oe(){c.hintElement&&(document.body.removeChild(c.hintElement),c.hintElement=null),c.bridgeElement&&(document.body.removeChild(c.bridgeElement),c.bridgeElement=null)}function J(n){if(c.timeoutId&&!c.isPressed){clearTimeout(c.timeoutId);const t=g.findIndex(e=>e.name===c.spiritName);if(t!==-1){const e=g[t];e.stats[0].level,c.action==="level-down"&&e.stats[0].level>0?e.stats[0].level=Math.max(0,e.stats[0].level-1):c.action==="level-up"&&e.stats[0].level<25&&(e.stats[0].level=Math.min(25,e.stats[0].level+1));const i=c.button.closest(".spirit-info-item-with-level").querySelector(".spirit-info-level");i&&(i.textContent=`Lv.${e.stats[0].level}`);const l=c.button.closest(".spirit-info-item-with-level").querySelector(".level-input");l&&(l.value=e.stats[0].level),P()}c.timeoutId=null,c.button=null,c.spiritName=null,c.action=null,c.mouseDownTime=null;return}if(c.isPressed){if(n.type==="touchend"&&c.hintElement){const t=c.hintElement.getBoundingClientRect();n.clientX>=t.left&&n.clientX<=t.right&&n.clientY>=t.top&&n.clientY<=t.bottom&&(c.hintHovered=!0)}if(c.hintHovered){const t=c.action==="level-down"?0:25,e=g.findIndex(i=>i.name===c.spiritName);if(e!==-1){g[e].stats[0].level=t;const i=c.button.closest(".spirit-info-item-with-level").querySelector(".spirit-info-level");i&&(i.textContent=`Lv.${t}`);const l=c.button.closest(".spirit-info-item-with-level").querySelector(".level-input");l&&(l.value=t),P()}}F()}}function ne(n,t){const e=n.target;if(e.classList.contains("level-btn"))return;if(e.classList.contains("level-input")){const l=e.dataset.spirit;let a=parseInt(e.value,10);(isNaN(a)||a<0)&&(a=0),a>25&&(a=25);const r=g.findIndex(o=>o.name===l);if(r!==-1){g[r].stats[0].level=a;const o=e.closest(".spirit-info-item-with-level").querySelector(".spirit-info-level");o&&(o.textContent=`Lv.${a}`),e.value=a,P()}return}const i=e.closest(".spirit-info-item-with-level");if(i&&!e.closest(".spirit-level-control")){const l=i.dataset.spiritName;y===l?y=null:y=l,document.querySelectorAll(".spirit-info-item-with-level").forEach(a=>{a.classList.remove("selected-used-spirit")}),y&&i.classList.add("selected-used-spirit"),P()}}function Re(n,t=!1){if(!n||!Array.isArray(n.combination)||n.combination.length===0){alert("ê³„ì‚° ê²°ê³¼ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");return}const{modal:e,content:i}=we();e.style.display="flex",document.body.style.overflow="hidden",y=n.selectedUsedSpirit||null,C=JSON.parse(JSON.stringify(n)),g=JSON.parse(JSON.stringify(n.spirits)),qe(n,i,t),setTimeout(()=>{try{window.adfit&&typeof window.adfit.render=="function"?document.querySelectorAll("#optimalModalContent .kakao_ad_area").forEach(a=>{window.adfit.render(a)}):k.warn("Kakao AdFit script (window.adfit) not yet loaded or not available.")}catch(l){k.error("Kakao AdFit: Error rendering ads in modal:",l)}},100)}function qe(n,t,e){const i=E("div","optimal-header",{id:"optimalHeader"}),l=E("div","combination-results-container",{id:"combinationResultsContainer"}),a=g.map(v=>`
      <div class="spirit-info-item-with-level ${y===v.name?"selected-used-spirit":""}" data-spirit-name="${v.name}">
          <div class="spirit-image-container">
              <img src="${v.image}" alt="${v.name}">
          </div>
          <div class="spirit-info-details">
              <div class="spirit-info-name">${v.name}</div>
              <div class="spirit-info-level">Lv.${v.stats[0].level}</div>
          </div>
          ${e?"":I(v.name)?`<div class="spirit-level-control">
                    <div class="fixed-level-control">
                      <span class="fixed-level-label">25 (ê³ ì •)</span>
                    </div>
                  </div>`:`<div class="spirit-level-control">
                    <button class="level-btn minus-btn" data-action="level-down" data-spirit="${v.name}">-</button>
                    <input type="number" class="level-input" min="0" max="25" value="${v.stats[0].level}" data-spirit="${v.name}">
                    <button class="level-btn plus-btn" data-action="level-up" data-spirit="${v.name}">+</button>
                  </div>`}
      </div>`).join("");l.innerHTML=`<div class="spirits-grid-container">${a}</div>`;const r=E("div","results-container");r.innerHTML=`
        <div class="results-section" id="registrationEffectSection" style="display: none;"></div>
        <div class="results-section" id="optimalGradeEffects"></div>
        <div class="results-section" id="optimalFactionEffects"></div>
        <div class="results-section" id="optimalBindEffects"></div>
    `;const o=E("div","spirit-details-container",{id:"optimalSpiritsDetails"}),d=E("div","kakao-ad-modal-container desktop-modal-ad",{});d.innerHTML=`
      <ins class="kakao_ad_area"
          data-ad-unit="DAN-avif2d68afxV6xpn"
          data-ad-width="728"
          data-ad-height="90"></ins>
  `,t.appendChild(d);const u=E("div","kakao-ad-modal-container mobile-modal-ad",{});if(u.innerHTML=`
      <ins class="kakao_ad_area"
          data-ad-unit="DAN-wnVEYOHZjycPISXg"
          data-ad-width="320"
          data-ad-height="50"></ins>
  `,t.appendChild(u),t.append(i),!e){const v=E("div","history-tabs-container",{id:"historyContainer"});t.appendChild(v)}t.append(l,r,o),Ie(t),setTimeout(()=>{X(n,e),e||n.spirits&&n.spirits.length>0&&n.spirits[0].type&&z(n.spirits[0].type)},10)}function X(n,t){const{gradeScore:e,factionScore:i,gradeEffects:l,factionEffects:a}=n,r=j(g),o=r.bindScore,d=r.bindStats,u=n.registrationScore||0,v=n.totalScoreWithRegistration||Math.round(S(e)+S(i)+S(o));u>0?`${v.toLocaleString()}${(v-u).toLocaleString()}`:`${v.toLocaleString()}`;let b,L;u>0?(b=`ì¡°í•© í•©ì‚°: ${v.toLocaleString()} (${(v-u).toLocaleString()})`,L="í•©ì‚° = ë“±ë¡ íš¨ê³¼ + ê²°ì† í•©ì‚° (ë“±ê¸‰ íš¨ê³¼ + ì„¸ë ¥ íš¨ê³¼ + ê²°ì† íš¨ê³¼)<br>í”¼í•´ì €í•­ê´€í†µ + í”¼í•´ì €í•­ + (ëŒ€ì¸í”¼í•´% Ã— 10) + (ëŒ€ì¸ë°©ì–´% Ã— 10)"):(b=`ì¡°í•© í•©ì‚°: ${v.toLocaleString()}`,L="í•©ì‚° = ê²°ì† í•©ì‚° (ë“±ê¸‰ íš¨ê³¼ + ì„¸ë ¥ íš¨ê³¼ + ê²°ì† íš¨ê³¼)<br>í”¼í•´ì €í•­ê´€í†µ + í”¼í•´ì €í•­ + (ëŒ€ì¸í”¼í•´% Ã— 10) + (ëŒ€ì¸ë°©ì–´% Ã— 10)"),document.getElementById("optimalHeader").innerHTML=`
        <div class="optimal-header-left">
          <h3 class="modal-main-title">
            ${b}
            <span class="score-formula">${L}</span>
          </h3>
        </div>
        <div class="optimal-header-right">
          ${t?"":'<button id="saveCombinationBtn" class="header-save-button">ì¡°í•© ì €ì¥</button>'}
        </div>
    `;const T=g.map(h=>`
      <div class="spirit-info-item-with-level ${y===h.name?"selected-used-spirit":""}" data-spirit-name="${h.name}">
          <div class="spirit-image-container">
              <img src="${h.image}" alt="${h.name}">
          </div>
          <div class="spirit-info-details">
              <div class="spirit-info-name">${h.name}</div>
              <div class="spirit-info-level">Lv.${h.stats[0].level}</div>
          </div>
          ${t?"":I(h.name)?`<div class="spirit-level-control">
                    <div class="fixed-level-control">
                      <span class="fixed-level-label">25 (ê³ ì •)</span>
                    </div>
                  </div>`:`<div class="spirit-level-control">
                    <button class="level-btn minus-btn" data-action="level-down" data-spirit="${h.name}">-</button>
                    <input type="number" class="level-input" min="0" max="25" value="${h.stats[0].level}" data-spirit="${h.name}">
                    <button class="level-btn plus-btn" data-action="level-up" data-spirit="${h.name}">+</button>
                  </div>`}
      </div>`).join(""),$=document.getElementById("combinationResultsContainer");$.innerHTML=`<div class="spirits-grid-container">${T}</div>`;const B=$.querySelector(".spirits-grid-container");t||(B.addEventListener("click",h=>ne(h)),B.addEventListener("input",h=>ne(h)),B.addEventListener("mousedown",pe),B.addEventListener("touchstart",Pe,{passive:!1}),document.addEventListener("mouseup",J),document.addEventListener("touchend",Ne));const D=document.getElementById("saveCombinationBtn");D&&!t&&(D.onclick=ke),R("optimalGradeEffects","ë“±ê¸‰ íš¨ê³¼",l||[],e,{gradeCounts:g.reduce((h,x)=>(x.grade&&(h[x.grade]=(h[x.grade]||0)+1),h),{})}),R("optimalFactionEffects","ì„¸ë ¥ íš¨ê³¼",a||[],i,{factionCounts:g.reduce((h,x)=>(x.influence&&(h[x.influence]=(h[x.influence]||0)+1),h),{})}),R("optimalBindEffects","ê²°ì† íš¨ê³¼",d,o),de(),ve(g),window.toggleMoreStats=ue}function z(n){const t=ce(n),e=document.getElementById("historyContainer");if(!e)return;if(t.length===0){e.innerHTML=`<p class="no-history-message">${n} ì¹´í…Œê³ ë¦¬ì— ì €ì¥ëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;return}let i=-1,l=null;const a=t.length>0?t[0].id:null;t.forEach(o=>{const d=o.totalScoreWithRegistration||Math.round(S(o.gradeScore)+S(o.factionScore)+S(o.bindScore));d>i&&(i=d,l=o.id)});const r=Array(5).fill(null).map((o,d)=>{const u=t[d];if(!u)return'<div class="history-tab-placeholder"></div>';const v=u.totalScoreWithRegistration||Math.round(S(u.gradeScore)+S(u.factionScore)+S(u.bindScore)),b=Math.round(S(u.gradeScore)+S(u.factionScore)+S(u.bindScore)),L=u.id===a,T=u.id===l,$=u.registrationScore>0?`${v.toLocaleString()}
(${b.toLocaleString()})`:v.toLocaleString();return`<div class="history-tab ${T?"best":""} ${L?"newest active":""}" data-history-id="${u.id}">
            <div class="history-delete-btn" data-category="${n}" data-id="${u.id}" title="ê¸°ë¡ ì‚­ì œ">Ã—</div>
            <div class="tab-indicators">
                ${L?'<span class="current-marker">New</span>':""}
                ${T?'<span class="best-marker">Best</span>':""}
            </div>
            <div class="tab-main-info">
                <span class="tab-score">${$}</span>
                <span class="tab-timestamp">${u.timestamp.substring(5,16)}</span>
            </div>
        </div>`}).join("");e.innerHTML=`<div class="history-tabs">${r}</div>`,e.querySelectorAll(".history-tab").forEach(o=>{o.addEventListener("click",d=>{if(d.target.classList.contains("history-delete-btn")){const b=d.target.dataset.category,L=parseInt(d.target.dataset.id,10);$e(b,L,d);return}e.querySelectorAll(".history-tab").forEach(b=>b.classList.remove("active")),o.classList.add("active");const u=parseInt(o.dataset.historyId,10),v=t.find(b=>b.id===u);v&&(y=v.selectedUsedSpirit||null,C=JSON.parse(JSON.stringify(v)),g=JSON.parse(JSON.stringify(v.spirits)),X(v,!1))})})}function ve(n){n.forEach((a,r)=>{});const t=document.getElementById("optimalSpiritsDetails");if(!t)return;const e=new Set;if(n.forEach(a=>{const r=w.allSpirits.find(u=>u.name===a.name&&u.type===a.type);if(!r)return;const o=a.stats[0].level,d=r.stats.find(u=>u.level===o);d?.bindStat&&Object.keys(d.bindStat).forEach(u=>e.add(u))}),e.size===0){t.innerHTML="<h4>ìƒì„¸ ìŠ¤íƒ¯ ë¹„êµ</h4><p>ì„ íƒëœ í™˜ìˆ˜ì˜ ì¥ì°© íš¨ê³¼ ìŠ¤íƒ¯ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";return}const i=[...e].sort();let l=`
        <h4>ìƒì„¸ ìŠ¤íƒ¯ ë¹„êµ</h4>
        <div class="table-wrapper">
            <table class="spirits-stats-table">
                <thead>
                    <tr>
                        <th>ëŠ¥ë ¥ì¹˜</th>
                        ${n.map(a=>`<th><img src="${a.image}" class="spirit-thumbnail" alt="${a.name}" title="${a.name}"><br><span class="spirit-table-name">${a.name}</span></th>`).join("")}
                        <th class="stat-total-header">í•©ì‚°</th>
                    </tr>
                </thead>
                <tbody>
    `;i.forEach(a=>{const r=V[a]||"";let o=0,d="";const u=[];n.forEach(b=>{const L=w.allSpirits.find(h=>h.name===b.name&&h.type===b.type),T=b.stats[0].level,$=L?.stats.find(h=>h.level===T),B=S($?.bindStat?.[a]);o+=B,u.push({name:b.name,level:T,value:B});const D=q.includes(a)?`${B}%`:B.toLocaleString();d+=`<td>${B>0?D:"-"}</td>`});let v;a==="pvpDamagePercent"||a==="pvpDefensePercent"?v=o>0?`${(o*10).toLocaleString()}`:"-":q.includes(a)?v=`${o.toFixed(2)}%`:v=o.toLocaleString(),l+=`
        <tr class="${r}">
            <th>${W[a]||a}</th>
            ${d}
            <td class="stat-total">${o>0?v:"-"}</td>
        </tr>`}),l+="</tbody></table></div>",t.innerHTML=l}function O(){F(),document.removeEventListener("mouseup",J),A&&(document.removeEventListener("keydown",A._escListener),A.remove(),A=null),y=null,C=null,g=[],delete window.toggleMoreStats,document.body.style.overflow="auto"}let s={isPressed:!1,intervalId:null,timeoutId:null,hintElement:null,bridgeElement:null,hintHovered:!1,button:null,spiritName:null,action:null,mouseDownTime:null,touchStartTime:null,touchMoveHandler:null,ignoreMouseUp:!1};const f={currentCategory:"ìˆ˜í˜¸",selectedSpirits:new Map,groupByInfluence:!1,currentStatFilter:""},m={},p={};function Fe(){return`
    <div class="sub-tabs" id="bondCategoryTabs">
        <div class="tab active" data-category="ìˆ˜í˜¸">ìˆ˜í˜¸</div>
        <div class="tab" data-category="íƒ‘ìŠ¹">íƒ‘ìŠ¹</div>
        <div class="tab" data-category="ë³€ì‹ ">ë³€ì‹ </div>
    </div>

    <div class="view-toggle-container">
        <label class="toggle-switch">
            <input type="checkbox" id="influenceToggle">
            <span class="slider round"></span>
        </label>
        <span class="toggle-label">ì„¸ë ¥ë³„ ë³´ê¸°</span>
        <div class="stat-filter-container"></div>
        <a href="https://open.kakao.com/o/sUSXtUYe" target="_blank" class="kakao-gift-btn">
            <img src="assets/img/gift.png" alt="ì¹´ì¹´ì˜¤ ì„ ë¬¼í•˜ê¸° ì•„ì´ì½˜"
                style="height: 20px; vertical-align: middle; margin-right: 5px;">
            ê°œë°œìì—ê²Œ ì¹´í†¡ ì„ ë¬¼í•˜ê¸°
        </a>
    </div>
    <div class="bond-container">
        <div class="main-content">
            <div class="left-panel">
                <div class="section-header">
                    <h2 class="section-title">ì „ì²´ í™˜ìˆ˜ ëª©ë¡</h2>
                    <div class="selection-controls">
                        <button id="selectAllBtn" class="btn btn-sm btn-primary">ì „ì²´ì„ íƒ</button>
                        <button id="clearAllSelectionBtn" class="btn btn-sm btn-danger">ì „ì²´í•´ì œ</button>
                    </div>
                </div>
                <div id="spiritListContainer" class="spirit-selection"></div>
            </div>
            <div class="right-panel">
                <div class="selected-spirits-container">
                    <div class="selected-spirits-header">
                        <h3 class="selection-title">ì„ íƒëœ í™˜ìˆ˜ (<span id="selectedCount">0</span>)</h3>
                    </div>
                    <div id="selectedSpiritsList" class="selected-spirits"></div>
                    <div class="header-controls">
                        <div class="level-batch-control">
                            <label>ì¼ê´„ ë ˆë²¨:</label>
                            <input type="number" id="batchLevelInput" min="0" max="25" value="0">
                            <button id="applyBatchLevelBtn" class="btn btn-sm btn-primary">ì ìš©</button>
                        </div>
                        <div class="calculate-btn-small">
                            <button id="findOptimalBtn" class="btn btn-warning">ìµœì  ì¡°í•© ì°¾ê¸°</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>`}function H(){G(),_e(),M()}function G(){let n=Z();f.currentStatFilter&&(n=n.filter(t=>Ee(t,f.currentStatFilter))),He({container:m.spiritListContainer,spirits:n,onSpiritClick:ze,getSpiritState:t=>{const{hasFullRegistration:e,hasFullBind:i,hasLevel25Bind:l}=Be(t);return{selected:f.selectedSpirits.has(t.name),registrationCompleted:e,bondCompleted:i,level25BindAvailable:l}},groupByInfluence:f.groupByInfluence})}function Z(){const n=i=>i?parseInt(i.match(/\d+/)?.[0]||"999",10):999,e=(Array.isArray(w.allSpirits)?w.allSpirits:[]).filter(i=>i.type===f.currentCategory);return e.sort((i,l)=>{const a={ì „ì„¤:1,ë¶ˆë©¸:2},r=a[i.grade]||99,o=a[l.grade]||99;return r!==o?r-o:n(i.image)-n(l.image)}),e}function _e(){const n=m.selectedSpiritsList;n.innerHTML="";const t=[...f.selectedSpirits.values()].filter(l=>l.type===f.currentCategory);m.selectedCount.textContent=t.length;const e=document.getElementById("mobileSelectedCount");e&&(e.textContent=t.length);const i=document.getElementById("selectedSpiritsMobile");if(i&&(i.innerHTML=""),t.length===0){n.innerHTML="<p class='text-center text-sm text-light mt-lg'>ì„ íƒëœ í™˜ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p>",i&&(i.innerHTML="<p class='text-center text-sm text-light mt-lg'>ì„ íƒëœ í™˜ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p>");return}t.forEach(l=>{const a=E("div","selected-spirit-card");if(a.dataset.spiritName=l.name,a.innerHTML=`
        <button class="remove-spirit" data-action="remove" title="ì„ íƒ í•´ì œ">Ã—</button>
        <div class="selected-spirit-header">
            <img src="${l.image}" alt="${l.name}">
            <div class="spirit-info">
                <div class="spirit-name">${l.name}</div>
            </div>
        </div>
        <div class="spirit-level-control">
            ${I(l.name)?`<div class="fixed-level-control">
                <span class="fixed-level-label">25 (ê³ ì •)</span>
              </div>`:`<button class="level-btn minus-btn" data-action="level-down">-</button>
              <input type="number" class="level-input" min="0" max="25" value="${l.level}">
              <button class="level-btn plus-btn" data-action="level-up">+</button>`}
        </div>
        `,n.appendChild(a),i){const r=E("div","selected-spirit-card");r.dataset.spiritName=l.name,r.innerHTML=a.innerHTML,i.appendChild(r)}})}function M(){localStorage.setItem("bondCalculatorState",JSON.stringify({category:f.currentCategory,spirits:[...f.selectedSpirits.values()],groupByInfluence:f.groupByInfluence,currentStatFilter:f.currentStatFilter}))}function We(){const n=localStorage.getItem("bondCalculatorState");if(n)try{const t=JSON.parse(n);f.currentCategory=t.category||"ìˆ˜í˜¸",f.selectedSpirits=new Map((t.spirits||[]).map(e=>[e.name,e])),f.groupByInfluence=t.groupByInfluence||!1,f.currentStatFilter=t.currentStatFilter||""}catch(t){k.error("Error loading state from storage, resetting:",t),f.selectedSpirits=new Map,f.groupByInfluence=!1,f.currentStatFilter=""}}function Ue(){const n=m.container.querySelector(".stat-filter-container"),t=Array.isArray(w.allSpirits)?w.allSpirits:[];Ce(n,t,l=>{f.currentStatFilter=l,G()});const e=m.container.querySelector("#statFilter"),i=m.container.querySelector(".clear-filter-btn");e&&(e.value=f.currentStatFilter),i&&(i.style.display=f.currentStatFilter?"inline-flex":"none")}function Ve(){const n=document.getElementById("panelToggleContainer"),t=n?n.querySelector(".right-panel"):null;t&&(t.classList.toggle("collapsed"),n.querySelector(".toggle-icon").textContent=t.classList.contains("collapsed")?"â–²":"â–¼")}function Ye(){Q("mobileBatchLevel")}function je(){ct("mobileBatchLevel")}function Je(){ge()}function Xe(){p.containerClickHandler=Ge,m.container.addEventListener("click",p.containerClickHandler),p.containerMouseDownHandler=fe,p.globalMouseUpHandler=me,p.containerTouchStartHandler=Ze,p.containerTouchEndHandler=Qe,p.globalTouchEndHandler=et,m.container.addEventListener("mousedown",p.containerMouseDownHandler),m.container.addEventListener("touchstart",p.containerTouchStartHandler,{passive:!1}),m.container.addEventListener("touchend",p.containerTouchEndHandler,{passive:!1}),document.addEventListener("mouseup",p.globalMouseUpHandler),document.addEventListener("touchend",p.globalTouchEndHandler,{passive:!1}),m.container.addEventListener("mouseleave",tt),p.bondCategoryTabsClickHandler=a=>{const o=a.target.closest(".tab");o&&!o.classList.contains("active")&&(m.bondCategoryTabs.querySelector(".tab.active")?.classList.remove("active"),o.classList.add("active"),f.currentCategory=o.dataset.category,H())},m.bondCategoryTabs.addEventListener("click",p.bondCategoryTabsClickHandler),p.influenceToggleChangeHandler=at,m.influenceToggle.addEventListener("change",p.influenceToggleChangeHandler),p.selectedSpiritsListInputHandler=ie,m.selectedSpiritsList.addEventListener("input",p.selectedSpiritsListInputHandler),p.selectAllClickHandler=rt,m.selectAllBtn.addEventListener("click",p.selectAllClickHandler),p.clearAllSelectionClickHandler=ot,m.clearAllSelectionBtn.addEventListener("click",p.clearAllSelectionClickHandler),p.applyBatchLevelClickHandler=()=>Q("batchLevelInput"),m.applyBatchLevelBtn.addEventListener("click",p.applyBatchLevelClickHandler),p.findOptimalClickHandler=ge,m.findOptimalBtn.addEventListener("click",p.findOptimalClickHandler);const n=document.getElementById("panelToggleBtn"),t=document.getElementById("selectedSpiritsMobile"),e=document.getElementById("applyMobileBatchLevelBtn"),i=document.getElementById("setMaxMobileBatchLevelBtn"),l=document.getElementById("findOptimalMobileBtn");n&&(p.panelToggleBtnClickHandler=Ve,n.addEventListener("click",p.panelToggleBtnClickHandler)),t&&(p.mobileSelectedSpiritsListInputHandler=ie,t.addEventListener("input",p.mobileSelectedSpiritsListInputHandler),t.addEventListener("touchstart",p.containerTouchStartHandler,{passive:!1}),t.addEventListener("mousedown",p.containerMouseDownHandler)),e&&(p.applyMobileBatchLevelClickHandler=Ye,e.addEventListener("click",p.applyMobileBatchLevelClickHandler)),i&&(p.setMaxMobileBatchLevelClickHandler=je,i.addEventListener("click",p.setMaxMobileBatchLevelClickHandler)),l&&(p.findOptimalMobileClickHandler=Je,l.addEventListener("click",p.findOptimalMobileClickHandler))}function ze(n){if(!n)return;const t=n.name;if(f.selectedSpirits.has(t))f.selectedSpirits.delete(t);else{const e=I(t)?25:0;f.selectedSpirits.set(t,{...n,level:e})}H()}function Ge(n){const t=n.target;if(s.isPressed)return;const e=t.closest(".selected-spirit-card");if(e){const i=e.dataset.spiritName,l=f.selectedSpirits.get(i);if(!l){k.warn("Selected spirit not found in pageState for:",i);return}const a=t.dataset.action;let r=!1;switch(a){case"remove":f.selectedSpirits.delete(i),r=!0;break;case"level-down":if(I(i))break;l.level>0&&(l.level=Math.max(0,l.level-1),r=!0);break;case"level-up":if(I(i))break;l.level<25&&(l.level=Math.min(25,l.level+1),r=!0);break}r&&(M(),H())}s.mouseDownTime=null}function fe(n){const t=n.target,e=t.closest(".selected-spirit-card");if(!e)return;const i=t.dataset.action;if(i!=="level-down"&&i!=="level-up")return;n.preventDefault(),n.stopPropagation();const l=e.dataset.spiritName;f.selectedSpirits.get(l)&&(s.timeoutId&&clearTimeout(s.timeoutId),s.intervalId&&clearInterval(s.intervalId),s.isPressed=!1,s.button=t,s.spiritName=l,s.action=i,s.hintHovered=!1,s.mouseDownTime=Date.now(),s.timeoutId=setTimeout(()=>{s.button===t&&it()},300))}function Ze(n){const t=n.target;if(!t.closest(".selected-spirit-card"))return;const i=t.classList.contains("level-btn")||t.classList.contains("minus-btn")||t.classList.contains("plus-btn"),l=t.dataset.action;if(!i||l!=="level-down"&&l!=="level-up")return;n.preventDefault(),n.stopPropagation(),s.touchStartTime=Date.now();const a={target:n.target,preventDefault:()=>{},stopPropagation:()=>{}};fe(a)}function Qe(n){if(s.isPressed){const t=n.changedTouches[0];if(s.hintElement){const e=s.hintElement.getBoundingClientRect();if(t.clientX>=e.left&&t.clientX<=e.right&&t.clientY>=e.top&&t.clientY<=e.bottom){s.hintHovered=!0;const l=s.action==="level-down"?0:25,a=f.selectedSpirits.get(s.spiritName);a&&(a.level=l,M(),H())}}N(),n.preventDefault(),n.stopPropagation()}}function Ke(n){if(!s.isPressed)return;const t=n.touches[0],e=document.elementFromPoint(t.clientX,t.clientY),i=s.hintElement,l=s.bridgeElement;if(!i)return;const a=e===i||i.contains(e),r=e===l;a?s.hintHovered||(s.hintHovered=!0,i.style.transform="scale(1.2)",i.style.fontSize="12px",i.style.fontWeight="900",i.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)"):s.hintHovered&&!r&&(s.hintHovered=!1,i.style.transform="scale(1)",i.style.fontSize="10px",i.style.fontWeight="bold",i.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)")}function et(n){if(!s.isPressed&&!s.timeoutId)return;const t=n.changedTouches[0],e=s.touchStartTime?Date.now()-s.touchStartTime:0;if(e>0&&e<300&&!s.isPressed){s.timeoutId&&(clearTimeout(s.timeoutId),s.timeoutId=null);const l=s.spiritName,a=s.action,r=f.selectedSpirits.get(l);if(r&&a&&!I(l)){let o=!1;a==="level-down"&&r.level>0?(r.level=Math.max(0,r.level-1),o=!0):a==="level-up"&&r.level<25&&(r.level=Math.min(25,r.level+1),o=!0),o&&(M(),H())}s.button=null,s.spiritName=null,s.action=null,s.touchStartTime=null;return}if(s.isPressed){if(s.hintElement){const l=s.hintElement.getBoundingClientRect();if(t.clientX>=l.left&&t.clientX<=l.right&&t.clientY>=l.top&&t.clientY<=l.bottom){s.hintHovered=!0;const r=s.action==="level-down"?0:25,o=f.selectedSpirits.get(s.spiritName);o&&(o.level=r,M(),H())}}N(),s.touchMoveHandler&&(document.removeEventListener("touchmove",s.touchMoveHandler),s.touchMoveHandler=null),s.touchStartTime=null;return}if(s.timeoutId){const l={target:document.elementFromPoint(t.clientX,t.clientY),clientX:t.clientX,clientY:t.clientY,type:"touchend"};me(l)}s.touchMoveHandler&&(document.removeEventListener("touchmove",s.touchMoveHandler),s.touchMoveHandler=null),s.touchStartTime=null}function me(n){if(!s.ignoreMouseUp){if(s.timeoutId&&!s.isPressed){clearTimeout(s.timeoutId),s.timeoutId=null,s.button=null,s.spiritName=null,s.action=null;return}if(s.isPressed){if(n.type==="touchend"&&s.hintElement){const t=s.hintElement.getBoundingClientRect();n.clientX>=t.left&&n.clientX<=t.right&&n.clientY>=t.top&&n.clientY<=t.bottom&&(s.hintHovered=!0)}if(s.hintHovered){const t=s.action==="level-down"?0:25,e=f.selectedSpirits.get(s.spiritName);e&&(e.level=t,M(),H())}N()}}}function tt(n){if(s.isPressed){const t=n.relatedTarget===s.hintElement||s.hintElement?.contains(n.relatedTarget),e=n.relatedTarget===s.bridgeElement||s.bridgeElement?.contains(n.relatedTarget);if(t||e)return;N()}}function nt(n,t){const e=m.selectedSpiritsList.querySelector(`[data-spirit-name="${n}"]`);if(e){const l=e.querySelector(".level-input");l&&(l.value=t,l.setAttribute("value",t),l.dispatchEvent(new Event("input",{bubbles:!0})))}const i=document.getElementById("selectedSpiritsMobile");if(i){const l=i.querySelector(`[data-spirit-name="${n}"]`);if(l){const a=l.querySelector(".level-input");a&&(a.value=t,a.setAttribute("value",t),a.dispatchEvent(new Event("input",{bubbles:!0})))}}}function it(){if(!s.button)return;s.isPressed=!0,s.ignoreMouseUp=!0,setTimeout(()=>{s.ignoreMouseUp=!1},100);try{lt()}catch(t){k.error("createHint ì—ëŸ¬:",t)}const n=()=>{if(!s.isPressed)return!1;const t=f.selectedSpirits.get(s.spiritName);if(!t||I(s.spiritName))return!1;t.level;let e=!1;return s.action==="level-down"&&t.level>0?(t.level=Math.max(0,t.level-1),e=!0):s.action==="level-up"&&t.level<25&&(t.level=Math.min(25,t.level+1),e=!0),e?(M(),nt(s.spiritName,t.level),!0):!1};n(),s.intervalId=setInterval(()=>{n()||N()},200)}function N(){s.intervalId&&(clearInterval(s.intervalId),s.intervalId=null),s.timeoutId&&(clearTimeout(s.timeoutId),s.timeoutId=null),st(),s.touchMoveHandler&&(document.removeEventListener("touchmove",s.touchMoveHandler),s.touchMoveHandler=null),s.isPressed=!1,s.hintHovered=!1,s.bridgeElement=null,s.button=null,s.spiritName=null,s.action=null,s.mouseDownTime=null,s.touchStartTime=null,s.ignoreMouseUp=!1}function lt(){if(!s.button)return;const t=(s.action==="level-down"?0:25).toString(),e=document.createElement("div");e.className="level-hint",e.textContent=t;const i=s.button.getBoundingClientRect();e.style.position="fixed",e.style.top=i.top+"px",e.style.zIndex="1000",e.style.color="white",e.style.padding="0px 4px",e.style.margin="0",e.style.border="none",e.style.borderRadius="3px",e.style.fontSize="10px",e.style.fontWeight="bold",e.style.pointerEvents="none",e.style.cursor="pointer",e.style.whiteSpace="nowrap",e.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)",e.style.textAlign="center",e.style.height=i.height+"px",e.style.lineHeight=i.height+"px",e.style.width="32px",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.transition="all 0.2s ease",s.action==="level-down"?(e.style.left=i.left-36+"px",e.style.backgroundColor="#f44336"):(e.style.left=i.right+4+"px",e.style.backgroundColor="#4CAF50"),document.body.appendChild(e),s.hintElement=e,s.hintHovered=!1;const l=document.createElement("div");l.className="hint-bridge",l.style.position="fixed",l.style.top=i.top+"px",l.style.height=i.height+"px",l.style.zIndex="999",l.style.backgroundColor="transparent",l.style.pointerEvents="none",s.action==="level-down"?(l.style.left=i.left-36+"px",l.style.width=36+i.width+4+"px"):(l.style.left=i.left+"px",l.style.width=i.width+4+32+"px"),document.body.appendChild(l),s.bridgeElement=l;const a=()=>{s.isPressed&&(s.hintHovered=!0,e.style.transform="scale(1.2)",e.style.fontSize="12px",e.style.fontWeight="900",e.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)")},r=()=>{s.isPressed&&(s.hintHovered=!1,e.style.transform="scale(1)",e.style.fontSize="10px",e.style.fontWeight="bold",e.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)")},o=()=>{if(k.log("ğŸ¯ íŒíŠ¸ í´ë¦­/í„°ì¹˜ ì¢…ë£Œ",{isPressed:s.isPressed,hintHovered:s.hintHovered}),s.isPressed){if(s.hintHovered){const d=s.action==="level-down"?0:25,u=f.selectedSpirits.get(s.spiritName);u&&(u.level=d,M(),H())}N()}};e.addEventListener("mouseenter",a),e.addEventListener("mouseup",o),e.addEventListener("mouseleave",d=>{!l.contains(d.relatedTarget)&&d.relatedTarget!==l&&r()}),e.addEventListener("touchstart",d=>{d.preventDefault(),d.stopPropagation(),a()},{passive:!1}),e.addEventListener("touchend",d=>{d.preventDefault(),d.stopPropagation(),o()},{passive:!1}),s.touchMoveHandler=Ke,document.addEventListener("touchmove",s.touchMoveHandler),l.addEventListener("mouseleave",d=>{!e.contains(d.relatedTarget)&&d.relatedTarget!==e&&r()}),l.addEventListener("touchstart",d=>{d.preventDefault(),d.stopPropagation(),a()},{passive:!1}),l.addEventListener("touchend",d=>{d.preventDefault(),d.stopPropagation()},{passive:!1}),setTimeout(()=>{e&&s.isPressed&&(e.style.pointerEvents="auto"),l&&s.isPressed&&(l.style.pointerEvents="auto")},0)}function st(){s.hintElement&&(s.hintElement.remove(),s.hintElement=null),s.bridgeElement&&(s.bridgeElement.remove(),s.bridgeElement=null)}function at(n){f.groupByInfluence=n.target.checked,M(),G()}function ie(n){if(n.target.matches(".level-input")){const t=n.target.closest(".selected-spirit-card"),e=f.selectedSpirits.get(t.dataset.spiritName);if(e){if(I(t.dataset.spiritName)){n.target.value=25;return}let i=parseInt(n.target.value,10);(isNaN(i)||i<0)&&(i=0),i>25&&(i=25),e.level=i,n.target.value=i,M()}}}function ot(){Z().forEach(t=>{f.selectedSpirits.has(t.name)&&f.selectedSpirits.delete(t.name)}),H()}function rt(){Z().forEach(t=>{f.selectedSpirits.has(t.name)||f.selectedSpirits.set(t.name,{...t,level:0})}),H()}function Q(n){const t=document.getElementById(n),e=parseInt(t.value,10);if(isNaN(e)||e<0||e>25){alert("0ì—ì„œ 25 ì‚¬ì´ì˜ ë ˆë²¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}f.selectedSpirits.forEach(i=>{i.type===f.currentCategory&&(i.level=e)}),H()}function ct(n){const t=document.getElementById(n);t&&(t.value=25,Q(n))}async function ge(){const n=[...f.selectedSpirits.values()].filter(o=>o.type===f.currentCategory).map(o=>({name:o.name,level:o.level}));if(n.length===0){alert("í˜„ì¬ íƒ­ì—ì„œ ì„ íƒëœ í™˜ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.");return}K("calculate_optimal","Bond Calculator",{num_creatures:n.length,category:f.currentCategory});const t=document.getElementById("app-container"),e=performance.now(),i=n.length;let l="";i>6?l="ìµœì  ì¡°í•© íƒìƒ‰ ì¤‘...":l="ì¡°í•© ê³„ì‚° ì¤‘...",be(t,"ìµœì  ì¡°í•© ê³„ì‚° ì¤‘",l,0,"ì´ˆê¸°í™” ì¤‘...");let a=0;const r=setInterval(()=>{a<90&&(a+=Math.random()*10,i>6?_(a,`ì¡°í•© íƒìƒ‰ ì¤‘... ${Math.round(a)}%`):_(a,`ê³„ì‚° ì¤‘... ${Math.round(a)}%`))},500);try{const o=await Se(n);clearInterval(r),_(100,"ì™„ë£Œ!"),await new Promise(u=>setTimeout(u,300));const d=performance.now()-e;if(ee("bond",d,{num_creatures:i,score:o?.scoreWithBind||0}),!o||!o.spirits)throw new Error("APIì—ì„œ ìœ íš¨í•œ ì‘ë‹µì„ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");re(o),Re(o,!1),K("open_result_modal","Bond Calculator")}catch(o){clearInterval(r);const d=performance.now()-e;ee("bond",d,{num_creatures:i,success:!1}),te.handle(o,"Optimal combination calculation"),alert(te.getUserFriendlyMessage(o.message))}finally{ye()}}function dt(n){he(),n.innerHTML=Fe();const t=`
    <button class="panel-toggle-button" id="panelToggleBtn">
        ì„ íƒëœ í™˜ìˆ˜ <span id="mobileSelectedCount">0</span>ê°œ <span class="toggle-icon">â–²</span>
    </button>
    <div class="right-panel collapsed">
        <div class="selected-spirits-container">
            <div class="selected-spirits-header">
                <h3>ì„ íƒëœ í™˜ìˆ˜</h3>
                <div class="header-controls">
                    <div class="level-batch-control">
                        <label>ì¼ê´„ ë ˆë²¨ ì„¤ì •:</label>
                        <input type="number" id="mobileBatchLevel" min="0" max="25" value="0">
                        <button id="applyMobileBatchLevelBtn" class="btn btn-primary apply-level-btn">ì ìš©</button>
                        <button id="setMaxMobileBatchLevelBtn" class="btn btn-warning max-level-btn">Max</button>
                    </div>
                    <div class="calculate-btn-small">
                        <button id="findOptimalMobileBtn" class="btn btn-secondary">ì°¾ê¸°</button>
                    </div>
                </div>
            </div>
            <div id="selectedSpiritsMobile" class="selected-spirits"></div>
        </div>
    </div>`,e=E("div","panel-toggle-container",{id:"panelToggleContainer"});e.innerHTML=t,document.body.appendChild(e);const i=m;i.container=n,i.bondCategoryTabs=n.querySelector("#bondCategoryTabs"),i.spiritListContainer=n.querySelector("#spiritListContainer"),i.selectedSpiritsList=n.querySelector("#selectedSpiritsList"),i.selectedCount=n.querySelector("#selectedCount"),i.selectAllBtn=n.querySelector("#selectAllBtn"),i.clearAllSelectionBtn=n.querySelector("#clearAllSelectionBtn"),i.batchLevelInput=n.querySelector("#batchLevelInput"),i.applyBatchLevelBtn=n.querySelector("#applyBatchLevelBtn"),i.findOptimalBtn=n.querySelector("#findOptimalBtn"),i.influenceToggle=n.querySelector("#influenceToggle"),We(),n.querySelectorAll(".sub-tabs .tab").forEach(l=>{l.classList.toggle("active",l.dataset.category===f.currentCategory)}),m.influenceToggle.checked=f.groupByInfluence,Xe(),Ue(),H()}function ut(){return`
        <div class="content-block">
            <h2>í™˜ìˆ˜ ê²°ì† ê³„ì‚°ê¸° ì‚¬ìš© ì•ˆë‚´</h2>
            <p>í™˜ìˆ˜ ê²°ì† ì‹œìŠ¤í…œì€ 6ë§ˆë¦¬ í™˜ìˆ˜ì˜ ì¡°í•©ì„ í†µí•´ ë‹¤ì–‘í•œ ëŠ¥ë ¥ì¹˜ ì‹œë„ˆì§€ë¥¼ ì–»ëŠ” í•µì‹¬ ì½˜í…ì¸ ì…ë‹ˆë‹¤. 'ë°”ì—°í™”ì—°'ì˜ ê²°ì† ê³„ì‚°ê¸°ëŠ” ì—¬ëŸ¬ë¶„ì´ ë³´ìœ í•œ í™˜ìˆ˜ë“¤ë¡œ ë‹¬ì„±í•  ìˆ˜ ìˆëŠ” ìµœì ì˜ ì¡°í•©ì„ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.</p>
            <p>ì´ ê³„ì‚°ê¸°ëŠ” <strong>í”¼í•´ì €í•­, í”¼í•´ì €í•­ê´€í†µ, ëŒ€ì¸í”¼í•´%*10, ëŒ€ì¸ë°©ì–´%*10</strong>ë¥¼ í•©ì‚°í•œ 'í™˜ì‚° ì ìˆ˜'ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì ì˜ ì¡°í•©ì„ ì°¾ì•„ë‚´ë©°, ìœ ì „ ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ ìˆ˜ë§ì€ ê²½ìš°ì˜ ìˆ˜ë¥¼ ë¹ ë¥´ê²Œ íƒìƒ‰í•©ë‹ˆë‹¤.</p>

            <h3>ğŸ” í˜ì´ì§€ ê¸°ëŠ¥ ì„¤ëª…</h3>
            <ul>
                <li><strong>ì¹´í…Œê³ ë¦¬ ì„ íƒ:</strong> 'ìˆ˜í˜¸', 'íƒ‘ìŠ¹', 'ë³€ì‹ ' íƒ­ì„ í´ë¦­í•˜ì—¬ í•´ë‹¹ ì¢…ë¥˜ì˜ í™˜ìˆ˜ ëª©ë¡ì„ í™•ì¸í•˜ì„¸ìš”. ê²°ì† ì¡°í•©ì€ ë™ì¼ ì¹´í…Œê³ ë¦¬ ë‚´ì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                <li><strong>í™˜ìˆ˜ ì„ íƒ:</strong> ì¢Œì¸¡ 'ì „ì²´ í™˜ìˆ˜ ëª©ë¡'ì—ì„œ ê²°ì† ì¡°í•©ì— ì‚¬ìš©í•  í™˜ìˆ˜ë¥¼ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”. ì„ íƒëœ í™˜ìˆ˜ëŠ” ìš°ì¸¡ 'ì„ íƒëœ í™˜ìˆ˜' ëª©ë¡ì— ì¶”ê°€ë©ë‹ˆë‹¤. (ë ˆë²¨ì€ 0ìœ¼ë¡œ ìë™ ì„¤ì •ë©ë‹ˆë‹¤.)</li>
                <li><strong>ì „ì²´ ì„ íƒ/í•´ì œ:</strong> 'í˜„ì¬ íƒ­ ì „ì²´ ì„ íƒ' ë˜ëŠ” 'í˜„ì¬ íƒ­ ì „ì²´ í•´ì œ' ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ëª¨ë“  í™˜ìˆ˜ë¥¼ í•œ ë²ˆì— ì„ íƒí•˜ê±°ë‚˜ í•´ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                <li><strong>í™˜ìˆ˜ ë ˆë²¨ ì¡°ì ˆ:</strong> ìš°ì¸¡ ì„ íƒëœ í™˜ìˆ˜ ëª©ë¡ì—ì„œ ê° í™˜ìˆ˜ì˜ ë ˆë²¨ì„ 0~25 ì‚¬ì´ë¡œ ì¡°ì ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 'ì¼ê´„ ë ˆë²¨ ì ìš©' ê¸°ëŠ¥ìœ¼ë¡œ ëª¨ë“  í™˜ìˆ˜ì˜ ë ˆë²¨ì„ í•œ ë²ˆì— ë³€ê²½í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</li>
                <li><strong>ìµœì  ì¡°í•© ì°¾ê¸°:</strong> 'ìµœì  ì¡°í•© ì°¾ê¸°' ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì„ íƒëœ í™˜ìˆ˜ë“¤ ì¤‘ ê°€ì¥ ë†’ì€ í™˜ì‚° ì ìˆ˜ë¥¼ ë‚´ëŠ” 6ë§ˆë¦¬ ì¡°í•©ì„ ì°¾ì•„ ëª¨ë‹¬ ì°½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.</li>
                <li><strong>ê²°ê³¼ ëª¨ë‹¬ í™•ì¸:</strong>
                    <ul>
                        <li><strong>ì¡°í•© í•©ì‚° ì ìˆ˜:</strong> ëª¨ë‹¬ í—¤ë”ì— 'ì¡°í•© í•©ì‚°: 1234 (123)' í˜•ì‹ìœ¼ë¡œ ì´ì ìˆ˜(ë“±ë¡í¬í•¨)ì™€ ê²°ì†ì ìˆ˜ë¥¼ í•¨ê»˜ í‘œì‹œí•©ë‹ˆë‹¤. ë“±ë¡ íš¨ê³¼ê°€ ì—†ì„ ê²½ìš° 'ì¡°í•© í•©ì‚°: 1234' í˜•ì‹ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</li>
                        <li><strong>ì¡°í•© ì €ì¥ ë²„íŠ¼:</strong> í—¤ë” ìš°ì¸¡ì— ìœ„ì¹˜í•œ 'ì¡°í•© ì €ì¥' ë²„íŠ¼ìœ¼ë¡œ í˜„ì¬ ì¡°í•©ì„ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                        <li><strong>í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ í™˜ìˆ˜ ì„ íƒ:</strong> ê²°ê³¼ ëª¨ë‹¬ì˜ ì¡°í•© í™˜ìˆ˜ ëª©ë¡ì—ì„œ í˜„ì¬ ê²Œì„ì—ì„œ ì‚¬ìš© ì¤‘ì¸ í™˜ìˆ˜ë¥¼ í´ë¦­í•˜ë©´ ë“±ë¡ íš¨ê³¼ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ í—¤ë” ì ìˆ˜ì— ë°˜ì˜ë©ë‹ˆë‹¤.</li>
                        <li><strong>ë ˆë²¨ ì¡°ì ˆ (ì¥ê¸° ëˆ„ë¥´ê¸°):</strong> ê° í™˜ìˆ˜ì˜ +/- ë²„íŠ¼ì„ ì§§ê²Œ ëˆ„ë¥´ë©´ 1ë ˆë²¨ì”©, ê¸¸ê²Œ ëˆ„ë¥´ë©´ ì—°ì†ìœ¼ë¡œ ë ˆë²¨ì´ ë³€ê²½ë©ë‹ˆë‹¤. ëª¨ë°”ì¼ì—ì„œë„ í„°ì¹˜ë¡œ ë™ì¼í•˜ê²Œ ì‘ë™í•˜ë©°, ì¡°í•© í•©ì‚° ì ìˆ˜ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.</li>
                        <li><strong>ì¡°í•© í™˜ìˆ˜:</strong> ì„ íƒëœ 6ë§ˆë¦¬ í™˜ìˆ˜ì˜ ëª©ë¡ì„ ë³´ì—¬ì£¼ë©°, ê° í™˜ìˆ˜ì˜ ë ˆë²¨ë„ í‘œì‹œë©ë‹ˆë‹¤.</li>
                        <li><strong>íš¨ê³¼ë³„ ìŠ¤íƒ¯:</strong> ë“±ê¸‰, ì„¸ë ¥, ì¥ì°© íš¨ê³¼ë¡œ ì¸í•´ ì¦ê°€í•˜ëŠ” ëŠ¥ë ¥ì¹˜ ëª©ë¡ê³¼ í•©ì‚° ì ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                        <li><strong>ìƒì„¸ ìŠ¤íƒ¯ ë¹„êµ:</strong> ì„ íƒëœ 6ë§ˆë¦¬ í™˜ìˆ˜ ê°ê°ì˜ ìƒì„¸ ì¥ì°© ìŠ¤íƒ¯ê³¼ ì´í•©ì„ ë¹„êµí•˜ì—¬ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    </ul>
                </li>
                <li><strong>ê¸°ë¡ íƒ­:</strong> ì´ì „ì— ê³„ì‚°í–ˆë˜ ìµœì  ì¡°í•© ê²°ê³¼ë“¤ì„ ê¸°ë¡ íƒ­ì—ì„œ ë‹¤ì‹œ í™•ì¸í•˜ê³  ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 'ìµœì‹ ', 'ìµœê³ ' ì ìˆ˜ë¥¼ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
            </ul>

            <h3>ğŸ’¡ ê²°ì† ì‹œìŠ¤í…œ íŒ & ì „ëµ</h3>
            <ul>
                <li><strong>PvEì™€ PvP ì¡°í•©:</strong> ë³´ìŠ¤ ì‚¬ëƒ¥ì„ ìœ„í•œ ì¡°í•©(í”¼í•´ì €í•­ê´€í†µ, ë³´ìŠ¤ëª¬ìŠ¤í„°ì¶”ê°€í”¼í•´)ê³¼ PvPë¥¼ ìœ„í•œ ì¡°í•©(ëŒ€ì¸ë°©ì–´%, í”¼í•´ì €í•´)ì€ ìŠ¤íƒ¯ ìš°ì„ ìˆœìœ„ê°€ ë‹¤ë¦…ë‹ˆë‹¤. ëª©í‘œì— ë§ëŠ” ì¡°í•©ì„ ì°¾ì•„ë³´ì„¸ìš”.</li>
                <li><strong>ë“±ê¸‰ ì‹œë„ˆì§€ vs ì„¸ë ¥ ì‹œë„ˆì§€:</strong> ì „ì„¤/ë¶ˆë©¸ í™˜ìˆ˜ ê°¯ìˆ˜ì— ë”°ë¥¸ ë“±ê¸‰ ì‹œë„ˆì§€ì™€ ê°™ì€ ì„¸ë ¥ í™˜ìˆ˜ ê°¯ìˆ˜ì— ë”°ë¥¸ ì„¸ë ¥ ì‹œë„ˆì§€ì„ ëª¨ë‘ ê³ ë ¤í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë•Œë¡œëŠ” ë‚®ì€ ë“±ê¸‰ì´ë¼ë„ ì„¸ë ¥ ì‹œë„ˆì§€ë¥¼ ë§ì¶”ëŠ” ê²ƒì´ ë” ìœ ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                <li><strong>ì‹¤ì‹œê°„ ë ˆë²¨ ì¡°ì •:</strong> ê²°ê³¼ ëª¨ë‹¬ì—ì„œ ê° í™˜ìˆ˜ì˜ ë ˆë²¨ì„ +/- ë²„íŠ¼ìœ¼ë¡œ ì¡°ì •í•˜ë©´ ì¡°í•© í•©ì‚° ì ìˆ˜ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤. ì¥ê¸° ëˆ„ë¥´ê¸°ë¡œ ë¹ ë¥´ê²Œ ë ˆë²¨ì„ ë³€ê²½í•  ìˆ˜ ìˆìœ¼ë©°, ëª¨ë°”ì¼ì—ì„œë„ í„°ì¹˜ë¡œ ë™ì¼í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤.</li>
                <li><strong>ê³ ë ˆë²¨ í™˜ìˆ˜ì˜ ì¤‘ìš”ì„±:</strong> ì¥ì°© íš¨ê³¼ëŠ” í™˜ìˆ˜ ë ˆë²¨ì— ë”°ë¼ í¬ê²Œ ì¦ê°€í•˜ë¯€ë¡œ, ì£¼ìš” í™˜ìˆ˜ëŠ” 25ë ˆë²¨ê¹Œì§€ ìœ¡ì„±í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ë ˆë²¨ ì¡°ì • ê¸°ëŠ¥ìœ¼ë¡œ ë ˆë²¨ë³„ ì ìˆ˜ ë³€í™”ë¥¼ ì¦‰ì‹œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                <li><strong>ëª¨ë“  í™˜ìˆ˜ í™œìš©:</strong> ë‹¨ìˆœíˆ ë³´ìœ  í™˜ìˆ˜ ì¤‘ ê°•í•œ í™˜ìˆ˜ 6ë§ˆë¦¬ë¥¼ ê³ ë¥´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê²°ì† ê³„ì‚°ê¸°ë¥¼ í†µí•´ ì˜ˆìƒì¹˜ ëª»í•œ ì¡°í•©ì´ ë” ì¢‹ì€ ê²°ê³¼ë¥¼ ë‚¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</li>
                <li><strong>ë“±ë¡ íš¨ê³¼ í™œìš©:</strong> ê²°ê³¼ ëª¨ë‹¬ì—ì„œ í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ í™˜ìˆ˜ë¥¼ ì„ íƒí•˜ì—¬ ë“±ë¡ íš¨ê³¼ë¥¼ ë°˜ì˜í•˜ë©´ ì‹¤ì œ ê²Œì„ì—ì„œì˜ ì´ ëŠ¥ë ¥ì¹˜ë¥¼ ì •í™•íˆ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í—¤ë”ì— 'ì¡°í•© í•©ì‚°: ì´ì  (ê²°ì†ì )' í˜•ì‹ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</li>
                <li><strong>ë¹ ë¥¸ ì¡°í•© ì €ì¥:</strong> í—¤ë” ìš°ì¸¡ì˜ 'ì¡°í•© ì €ì¥' ë²„íŠ¼ìœ¼ë¡œ í˜„ì¬ ì¡°í•©ì„ ê¸°ë¡ íƒ­ì— ì €ì¥í•˜ì—¬ ë‚˜ì¤‘ì— ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
            </ul>
        </div>
    `}function he(){if(m.container){m.bondCategoryTabs&&p.bondCategoryTabsClickHandler&&m.bondCategoryTabs.removeEventListener("click",p.bondCategoryTabsClickHandler),m.container&&p.containerClickHandler&&m.container.removeEventListener("click",p.containerClickHandler),m.influenceToggle&&p.influenceToggleChangeHandler&&m.influenceToggle.removeEventListener("change",p.influenceToggleChangeHandler),m.selectedSpiritsList&&p.selectedSpiritsListInputHandler&&m.selectedSpiritsList.removeEventListener("input",p.selectedSpiritsListInputHandler),m.selectAllBtn&&p.selectAllClickHandler&&m.selectAllBtn.removeEventListener("click",p.selectAllClickHandler),m.clearAllSelectionBtn&&p.clearAllSelectionClickHandler&&m.clearAllSelectionBtn.removeEventListener("click",p.clearAllSelectionClickHandler),m.applyBatchLevelBtn&&p.applyBatchLevelClickHandler&&m.applyBatchLevelBtn.removeEventListener("click",p.applyBatchLevelClickHandler),m.findOptimalBtn&&p.findOptimalClickHandler&&m.findOptimalBtn.removeEventListener("click",p.findOptimalClickHandler);const n=document.getElementById("panelToggleBtn"),t=document.getElementById("selectedSpiritsMobile"),e=document.getElementById("applyMobileBatchLevelBtn"),i=document.getElementById("setMaxMobileBatchLevelBtn"),l=document.getElementById("findOptimalMobileBtn");n&&p.panelToggleBtnClickHandler&&n.removeEventListener("click",p.panelToggleBtnClickHandler),t&&p.mobileSelectedSpiritsListInputHandler&&t.removeEventListener("input",p.mobileSelectedSpiritsListInputHandler),e&&p.applyMobileBatchLevelClickHandler&&e.removeEventListener("click",p.applyMobileBatchLevelClickHandler),i&&p.setMaxMobileBatchLevelClickHandler&&i.removeEventListener("click",p.setMaxMobileBatchLevelClickHandler),l&&p.findOptimalMobileClickHandler&&l.removeEventListener("click",p.findOptimalMobileClickHandler);const a=document.getElementById("panelToggleContainer");a&&a.remove()}}const mt=Object.freeze(Object.defineProperty({__proto__:null,cleanup:he,getHelpContentHTML:ut,init:dt},Symbol.toStringTag,{value:"Module"}));export{mt as b,Re as s};
